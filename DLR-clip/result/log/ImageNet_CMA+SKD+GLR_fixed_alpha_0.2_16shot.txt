2025-12-17 22:02:32 Preparing ViT-B/16 model.
2025-12-17 22:02:34 Getting cached textual weights W ...
2025-12-17 22:02:34 Initializing CMA adapter learner...
2025-12-17 22:02:35 Initializing SKD distillation...
2025-12-17 22:02:35 Preparing imagenet dataset.
2025-12-17 22:08:00 train acc=0.709875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0011069248914718627, 0.0, 1.11476416015625, 1.06862255859375, 0.65905517578125]
2025-12-17 22:08:00 Epoch: 0, loss: 2.1911, lr: 0.00009990
2025-12-17 22:13:27 train acc=0.7245625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0021315088272094726, 0.0, 1.1192841796875, 0.99407666015625, 0.8287490234375]
2025-12-17 22:13:27 Epoch: 1, loss: 2.1238, lr: 0.00009961
2025-12-17 22:18:53 train acc=0.7376875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0023782196044921876, 0.0, 1.11907421875, 0.9421240234375, 0.9724580078125]
2025-12-17 22:18:53 Epoch: 2, loss: 2.0733, lr: 0.00009911
2025-12-17 22:24:17 train acc=0.751875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0022674732208251953, 0.0, 1.11443798828125, 0.883563720703125, 1.166080078125]
2025-12-17 22:24:17 Epoch: 3, loss: 2.0119, lr: 0.00009843
2025-12-17 22:29:40 train acc=0.7656875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0022800407409667967, 0.0, 1.116099609375, 0.8245849609375, 1.44859765625]
2025-12-17 22:29:40 Epoch: 4, loss: 1.9575, lr: 0.00009755
2025-12-17 22:35:03 train acc=0.7788125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0026526260375976563, 0.0, 1.1196435546875, 0.77031640625, 1.745923828125]
2025-12-17 22:35:04 Epoch: 5, loss: 1.9100, lr: 0.00009649
2025-12-17 22:40:27 train acc=0.7953125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0033115787506103516, 0.0, 1.11455810546875, 0.70864453125, 2.057796875]
2025-12-17 22:40:27 Epoch: 6, loss: 1.8471, lr: 0.00009524
2025-12-17 22:45:50 train acc=0.8094375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.004134607315063476, 0.0, 1.115701171875, 0.656075927734375, 2.341865234375]
2025-12-17 22:45:50 Epoch: 7, loss: 1.7993, lr: 0.00009382
2025-12-17 22:51:14 train acc=0.8230625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.00526595687866211, 0.0, 1.11523291015625, 0.607560791015625, 2.65103515625]
2025-12-17 22:51:14 Epoch: 8, loss: 1.7546, lr: 0.00009222
2025-12-17 22:56:38 train acc=0.83625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0066385726928710935, 0.0, 1.1099931640625, 0.56377294921875, 2.907140625]
2025-12-17 22:56:38 Epoch: 9, loss: 1.7095, lr: 0.00009045
2025-12-17 23:02:02 train acc=0.8456875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.007913361549377442, 0.0, 1.1064775390625, 0.529413330078125, 3.22226953125]
2025-12-17 23:02:02 Epoch: 10, loss: 1.6761, lr: 0.00008853
2025-12-17 23:07:27 train acc=0.8534375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.010198256492614747, 0.0, 1.1079091796875, 0.502352294921875, 3.37325390625]
2025-12-17 23:07:27 Epoch: 11, loss: 1.6542, lr: 0.00008645
2025-12-17 23:12:52 train acc=0.863625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.013116546630859375, 0.0, 1.10060546875, 0.471173583984375, 3.62844921875]
2025-12-17 23:12:52 Epoch: 12, loss: 1.6212, lr: 0.00008423
2025-12-17 23:18:17 train acc=0.8721875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.01628936767578125, 0.0, 1.0957890625, 0.44843115234375, 3.79806640625]
2025-12-17 23:18:17 Epoch: 13, loss: 1.5985, lr: 0.00008187
2025-12-17 23:23:42 train acc=0.8795, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.019958648681640625, 0.0, 1.08327001953125, 0.427556640625, 3.92829296875]
2025-12-17 23:23:42 Epoch: 14, loss: 1.5701, lr: 0.00007939
2025-12-17 23:29:07 train acc=0.8834375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.022921051025390625, 0.0, 1.08104833984375, 0.4120047607421875, 4.0666796875]
2025-12-17 23:29:07 Epoch: 15, loss: 1.5567, lr: 0.00007679
2025-12-17 23:34:31 train acc=0.886375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.02660400390625, 0.0, 1.07669580078125, 0.3973233642578125, 4.24598828125]
2025-12-17 23:34:31 Epoch: 16, loss: 1.5430, lr: 0.00007409
2025-12-17 23:39:56 train acc=0.8919375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.030246917724609374, 0.0, 1.05925, 0.3772213134765625, 4.35290234375]
2025-12-17 23:39:56 Epoch: 17, loss: 1.5102, lr: 0.00007129
2025-12-17 23:45:21 train acc=0.8965, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03369873046875, 0.0, 1.05226171875, 0.3698822021484375, 4.46683203125]
2025-12-17 23:45:21 Epoch: 18, loss: 1.5005, lr: 0.00006841
2025-12-17 23:50:46 train acc=0.9013125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03751788330078125, 0.0, 1.0472080078125, 0.3576214599609375, 4.5416640625]
2025-12-17 23:50:46 Epoch: 19, loss: 1.4878, lr: 0.00006545
2025-12-17 23:56:10 train acc=0.9035, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0408321533203125, 0.0, 1.04233447265625, 0.349152099609375, 4.62975]
2025-12-17 23:56:10 Epoch: 20, loss: 1.4786, lr: 0.00006243
2025-12-18 00:01:35 train acc=0.9046875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04427410888671875, 0.0, 1.0349580078125, 0.3421226806640625, 4.71462109375]
2025-12-18 00:01:35 Epoch: 21, loss: 1.4685, lr: 0.00005937
2025-12-18 00:07:00 train acc=0.9094375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04739532470703125, 0.0, 1.02106640625, 0.33121905517578126, 4.74853515625]
2025-12-18 00:07:00 Epoch: 22, loss: 1.4471, lr: 0.00005627
2025-12-18 00:12:24 train acc=0.9103125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05039794921875, 0.0, 1.01521337890625, 0.3258997802734375, 4.777984375]
2025-12-18 00:12:24 Epoch: 23, loss: 1.4393, lr: 0.00005314
2025-12-18 00:17:49 train acc=0.911375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.053008544921875, 0.0, 1.00325830078125, 0.316956298828125, 4.88615234375]
2025-12-18 00:17:49 Epoch: 24, loss: 1.4221, lr: 0.00005000
2025-12-18 00:23:14 train acc=0.9118125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05625555419921875, 0.0, 0.997234375, 0.3188641357421875, 4.8706171875]
2025-12-18 00:23:14 Epoch: 25, loss: 1.4211, lr: 0.00004686
2025-12-18 00:28:38 train acc=0.9155625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.059125732421875, 0.0, 0.990775390625, 0.3075784912109375, 4.9180703125]
2025-12-18 00:28:38 Epoch: 26, loss: 1.4067, lr: 0.00004373
2025-12-18 00:34:03 train acc=0.9154375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06164581298828125, 0.0, 0.98247607421875, 0.3062174072265625, 4.9596484375]
2025-12-18 00:34:03 Epoch: 27, loss: 1.3999, lr: 0.00004063
2025-12-18 00:39:28 train acc=0.9186875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0640189208984375, 0.0, 0.9739794921875, 0.3003975830078125, 4.9765703125]
2025-12-18 00:39:28 Epoch: 28, loss: 1.3882, lr: 0.00003757
2025-12-18 00:44:52 train acc=0.91725, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06612359619140624, 0.0, 0.97092822265625, 0.29878369140625, 4.9633125]
2025-12-18 00:44:53 Epoch: 29, loss: 1.3855, lr: 0.00003455
2025-12-18 00:50:17 train acc=0.9205625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0681900634765625, 0.0, 0.96446240234375, 0.2959354248046875, 4.96803125]
2025-12-18 00:50:17 Epoch: 30, loss: 1.3783, lr: 0.00003159
2025-12-18 00:55:42 train acc=0.921125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0702618408203125, 0.0, 0.9526943359375, 0.2938905029296875, 4.97472265625]
2025-12-18 00:55:42 Epoch: 31, loss: 1.3666, lr: 0.00002871
2025-12-18 01:01:07 train acc=0.9233125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.07183782958984375, 0.0, 0.9509873046875, 0.291834228515625, 4.9795]
2025-12-18 01:01:07 Epoch: 32, loss: 1.3645, lr: 0.00002591
2025-12-18 01:06:32 train acc=0.9216875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.07330908203125, 0.0, 0.94370947265625, 0.2896610107421875, 4.9784140625]
2025-12-18 01:06:32 Epoch: 33, loss: 1.3565, lr: 0.00002321
2025-12-18 01:11:56 train acc=0.9230625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0744849853515625, 0.0, 0.93139453125, 0.2866332397460937, 4.94971484375]
2025-12-18 01:11:56 Epoch: 34, loss: 1.3420, lr: 0.00002061
2025-12-18 01:17:21 train acc=0.9229375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0759586181640625, 0.0, 0.93328564453125, 0.2869404296875, 4.94742578125]
2025-12-18 01:17:21 Epoch: 35, loss: 1.3456, lr: 0.00001813
2025-12-18 01:22:46 train acc=0.92475, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0768594970703125, 0.0, 0.9269365234375, 0.283878662109375, 4.966859375]
2025-12-18 01:22:46 Epoch: 36, loss: 1.3373, lr: 0.00001577
2025-12-18 01:28:11 train acc=0.923125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0780364990234375, 0.0, 0.92947509765625, 0.2878402099609375, 4.95709765625]
2025-12-18 01:28:11 Epoch: 37, loss: 1.3449, lr: 0.00001355
2025-12-18 01:33:35 train acc=0.923375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0786895751953125, 0.0, 0.920884765625, 0.28375689697265627, 4.950546875]
2025-12-18 01:33:35 Epoch: 38, loss: 1.3328, lr: 0.00001147
2025-12-18 01:39:00 train acc=0.9213125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.079137451171875, 0.0, 0.9165654296875, 0.28572998046875, 4.948015625]
2025-12-18 01:39:00 Epoch: 39, loss: 1.3309, lr: 0.00000955
2025-12-18 01:44:25 train acc=0.92375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0797904052734375, 0.0, 0.914884765625, 0.2827899169921875, 4.9418671875]
2025-12-18 01:44:25 Epoch: 40, loss: 1.3269, lr: 0.00000778
2025-12-18 01:49:49 train acc=0.9260625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0800262451171875, 0.0, 0.91387646484375, 0.2810362548828125, 4.9326640625]
2025-12-18 01:49:49 Epoch: 41, loss: 1.3243, lr: 0.00000618
2025-12-18 01:55:14 train acc=0.923, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0805203857421875, 0.0, 0.91082666015625, 0.28610888671875, 4.935359375]
2025-12-18 01:55:14 Epoch: 42, loss: 1.3268, lr: 0.00000476
2025-12-18 02:00:38 train acc=0.9263125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.08067626953125, 0.0, 0.90872021484375, 0.2818646240234375, 4.93248828125]
2025-12-18 02:00:38 Epoch: 43, loss: 1.3206, lr: 0.00000351
2025-12-18 02:06:03 train acc=0.9244375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0810941162109375, 0.0, 0.911400390625, 0.2835604248046875, 4.9307734375]
2025-12-18 02:06:03 Epoch: 44, loss: 1.3253, lr: 0.00000245
2025-12-18 02:11:28 train acc=0.927875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.081088623046875, 0.0, 0.90491943359375, 0.279438720703125, 4.92852734375]
2025-12-18 02:11:28 Epoch: 45, loss: 1.3147, lr: 0.00000157
2025-12-18 02:16:53 train acc=0.9271875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0809906005859375, 0.0, 0.90364990234375, 0.279740478515625, 4.9379921875]
2025-12-18 02:16:53 Epoch: 46, loss: 1.3137, lr: 0.00000089
2025-12-18 02:22:18 train acc=0.9246875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0811396484375, 0.0, 0.90402783203125, 0.2819793701171875, 4.9429921875]
2025-12-18 02:22:18 Epoch: 47, loss: 1.3166, lr: 0.00000039
2025-12-18 02:27:42 train acc=0.92775, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0812003173828125, 0.0, 0.9020576171875, 0.2809522705078125, 4.9258203125]
2025-12-18 02:27:42 Epoch: 48, loss: 1.3135, lr: 0.00000010
2025-12-18 02:33:07 train acc=0.9253125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0812562255859375, 0.0, 0.9045009765625, 0.2789481201171875, 4.92924609375]
2025-12-18 02:33:07 Epoch: 49, loss: 1.3140, lr: 0.00000000
2025-12-18 02:45:11 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 67.598, 'GLR_logits': 71.392, 'final_logits': 70.274, 'acc': 73.384}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-18 02:45:11 avg clip_logits acc=68.77
2025-12-18 02:45:11 avg cma_logits acc=67.598
2025-12-18 02:45:11 avg GLR_logits acc=71.392
2025-12-18 02:45:11 avg final_logits acc=70.274
2025-12-18 02:45:11 avg acc acc=73.384
