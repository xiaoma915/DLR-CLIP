2025-12-17 12:31:20 Preparing ViT-B/16 model.
2025-12-17 12:31:22 Getting cached textual weights W ...
2025-12-17 12:31:22 Initializing CMA adapter learner...
2025-12-17 12:31:23 Initializing SKD distillation...
2025-12-17 12:31:23 Preparing imagenet dataset.
2025-12-17 12:36:44 train acc=0.709625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0011283279657363892, 0.0, 1.11478271484375, 1.06853759765625, 0.65935302734375]
2025-12-17 12:36:44 Epoch: 0, loss: 2.1910, lr: 0.00009990
2025-12-17 12:42:05 train acc=0.725, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0021005749702453615, 0.0, 1.1193681640625, 0.99381201171875, 0.8302900390625]
2025-12-17 12:42:05 Epoch: 1, loss: 2.1236, lr: 0.00009961
2025-12-17 12:47:26 train acc=0.737375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0022664546966552736, 0.0, 1.1189384765625, 0.941141845703125, 0.9811630859375]
2025-12-17 12:47:26 Epoch: 2, loss: 2.0722, lr: 0.00009911
2025-12-17 12:52:47 train acc=0.7508125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0020822267532348633, 0.0, 1.114482421875, 0.88258154296875, 1.1758466796875]
2025-12-17 12:52:47 Epoch: 3, loss: 2.0109, lr: 0.00009843
2025-12-17 12:58:09 train acc=0.7656875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0022560768127441407, 0.0, 1.11622412109375, 0.8244541015625, 1.442853515625]
2025-12-17 12:58:09 Epoch: 4, loss: 1.9574, lr: 0.00009755
2025-12-17 13:03:29 train acc=0.7796875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0021883316040039063, 0.0, 1.1201669921875, 0.7681044921875, 1.760796875]
2025-12-17 13:03:29 Epoch: 5, loss: 1.9081, lr: 0.00009649
2025-12-17 13:08:50 train acc=0.7965, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0024821863174438476, 0.0, 1.11563916015625, 0.706191162109375, 2.083654296875]
2025-12-17 13:08:50 Epoch: 6, loss: 1.8452, lr: 0.00009524
2025-12-17 13:14:11 train acc=0.81, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0029457931518554687, 0.0, 1.11715966796875, 0.653820068359375, 2.355759765625]
2025-12-17 13:14:11 Epoch: 7, loss: 1.7974, lr: 0.00009382
2025-12-17 13:19:32 train acc=0.82425, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0037553253173828126, 0.0, 1.11707958984375, 0.60498095703125, 2.67391796875]
2025-12-17 13:19:32 Epoch: 8, loss: 1.7525, lr: 0.00009222
2025-12-17 13:24:53 train acc=0.837625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.004692184448242188, 0.0, 1.1126552734375, 0.5608759765625, 2.92780078125]
2025-12-17 13:24:53 Epoch: 9, loss: 1.7075, lr: 0.00009045
2025-12-17 13:30:14 train acc=0.8456875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.006369539260864258, 0.0, 1.1088232421875, 0.52598388671875, 3.2444453125]
2025-12-17 13:30:14 Epoch: 10, loss: 1.6736, lr: 0.00008853
2025-12-17 13:35:35 train acc=0.8544375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.008047275543212891, 0.0, 1.1113828125, 0.498698974609375, 3.40609765625]
2025-12-17 13:35:35 Epoch: 11, loss: 1.6522, lr: 0.00008645
2025-12-17 13:40:56 train acc=0.863125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.010304702758789062, 0.0, 1.10564404296875, 0.468513427734375, 3.65775390625]
2025-12-17 13:40:56 Epoch: 12, loss: 1.6210, lr: 0.00008423
2025-12-17 13:46:17 train acc=0.8741875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.012377090454101562, 0.0, 1.1026630859375, 0.446635986328125, 3.80946484375]
2025-12-17 13:46:17 Epoch: 13, loss: 1.5998, lr: 0.00008187
2025-12-17 13:51:38 train acc=0.8804375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.015373031616210937, 0.0, 1.091640625, 0.426038818359375, 3.93933203125]
2025-12-17 13:51:38 Epoch: 14, loss: 1.5725, lr: 0.00007939
2025-12-17 13:56:59 train acc=0.885625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.017698577880859375, 0.0, 1.08987646484375, 0.410500732421875, 4.06886328125]
2025-12-17 13:56:59 Epoch: 15, loss: 1.5588, lr: 0.00007679
2025-12-17 14:02:21 train acc=0.886875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.020422210693359377, 0.0, 1.08947314453125, 0.396400146484375, 4.2356171875]
2025-12-17 14:02:21 Epoch: 16, loss: 1.5486, lr: 0.00007409
2025-12-17 14:07:41 train acc=0.891875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.02333935546875, 0.0, 1.0738017578125, 0.376745849609375, 4.34262890625]
2025-12-17 14:07:41 Epoch: 17, loss: 1.5173, lr: 0.00007129
2025-12-17 14:13:03 train acc=0.8975625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.026209197998046874, 0.0, 1.06778857421875, 0.3703961181640625, 4.45069140625]
2025-12-17 14:13:03 Epoch: 18, loss: 1.5089, lr: 0.00006841
2025-12-17 14:18:24 train acc=0.9013125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0290311279296875, 0.0, 1.06464794921875, 0.35749951171875, 4.534359375]
2025-12-17 14:18:24 Epoch: 19, loss: 1.4965, lr: 0.00006545
2025-12-17 14:23:45 train acc=0.90475, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03140179443359375, 0.0, 1.06191748046875, 0.3492978515625, 4.6142890625]
2025-12-17 14:23:45 Epoch: 20, loss: 1.4888, lr: 0.00006243
2025-12-17 14:29:06 train acc=0.904375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03419125366210937, 0.0, 1.05543310546875, 0.34247119140625, 4.70809375]
2025-12-17 14:29:06 Epoch: 21, loss: 1.4792, lr: 0.00005937
2025-12-17 14:34:26 train acc=0.9088125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0368096923828125, 0.0, 1.04287451171875, 0.33152783203125, 4.7356328125]
2025-12-17 14:34:26 Epoch: 22, loss: 1.4586, lr: 0.00005627
2025-12-17 14:39:47 train acc=0.908875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03926129150390625, 0.0, 1.03861376953125, 0.3262474365234375, 4.75621875]
2025-12-17 14:39:47 Epoch: 23, loss: 1.4517, lr: 0.00005314
2025-12-17 14:45:08 train acc=0.91125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04146697998046875, 0.0, 1.02792431640625, 0.3183067626953125, 4.86520703125]
2025-12-17 14:45:08 Epoch: 24, loss: 1.4363, lr: 0.00005000
2025-12-17 14:50:29 train acc=0.912625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0436939697265625, 0.0, 1.02433251953125, 0.3202645263671875, 4.8594140625]
2025-12-17 14:50:29 Epoch: 25, loss: 1.4369, lr: 0.00004686
2025-12-17 14:55:50 train acc=0.915625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04596478271484375, 0.0, 1.01932421875, 0.3086190185546875, 4.90428515625]
2025-12-17 14:55:50 Epoch: 26, loss: 1.4229, lr: 0.00004373
2025-12-17 15:01:12 train acc=0.916, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04801092529296875, 0.0, 1.0132451171875, 0.307499267578125, 4.95534765625]
2025-12-17 15:01:12 Epoch: 27, loss: 1.4184, lr: 0.00004063
2025-12-17 15:06:33 train acc=0.919375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04962078857421875, 0.0, 1.0057939453125, 0.3016187744140625, 4.97077734375]
2025-12-17 15:06:33 Epoch: 28, loss: 1.4067, lr: 0.00003757
2025-12-17 15:11:53 train acc=0.916375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05171011352539062, 0.0, 1.0050390625, 0.30066552734375, 4.955671875]
2025-12-17 15:11:53 Epoch: 29, loss: 1.4069, lr: 0.00003455
2025-12-17 15:17:19 train acc=0.9198125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0536949462890625, 0.0, 1.00309423828125, 0.29822698974609374, 4.9723203125]
2025-12-17 15:17:19 Epoch: 30, loss: 1.4047, lr: 0.00003159
2025-12-17 15:22:43 train acc=0.9211875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05580816650390625, 0.0, 0.991533203125, 0.295848876953125, 4.986328125]
2025-12-17 15:22:43 Epoch: 31, loss: 1.3930, lr: 0.00002871
2025-12-17 15:28:08 train acc=0.92275, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05699676513671875, 0.0, 0.99096435546875, 0.294390380859375, 4.9816953125]
2025-12-17 15:28:08 Epoch: 32, loss: 1.3922, lr: 0.00002591
2025-12-17 15:33:34 train acc=0.9236875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0581251220703125, 0.0, 0.984900390625, 0.2908060302734375, 4.9936796875]
2025-12-17 15:33:34 Epoch: 33, loss: 1.3838, lr: 0.00002321
2025-12-17 15:38:59 train acc=0.9220625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05917034912109375, 0.0, 0.97419580078125, 0.2891859130859375, 4.9632421875]
2025-12-17 15:38:59 Epoch: 34, loss: 1.3722, lr: 0.00002061
2025-12-17 15:44:23 train acc=0.92275, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06009002685546875, 0.0, 0.9768203125, 0.289183837890625, 4.96192578125]
2025-12-17 15:44:23 Epoch: 35, loss: 1.3757, lr: 0.00001813
2025-12-17 15:49:48 train acc=0.9226875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.060793701171875, 0.0, 0.971111328125, 0.2865345458984375, 4.9855546875]
2025-12-17 15:49:48 Epoch: 36, loss: 1.3683, lr: 0.00001577
2025-12-17 15:55:12 train acc=0.922, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06167230224609375, 0.0, 0.97584130859375, 0.29024658203125, 4.9815625]
2025-12-17 15:55:12 Epoch: 37, loss: 1.3776, lr: 0.00001355
2025-12-17 16:00:37 train acc=0.923, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0620782470703125, 0.0, 0.9673828125, 0.2862808837890625, 4.972109375]
2025-12-17 16:00:37 Epoch: 38, loss: 1.3655, lr: 0.00001147
2025-12-17 16:06:01 train acc=0.9219375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0626629638671875, 0.0, 0.96305029296875, 0.2883172607421875, 4.96456640625]
2025-12-17 16:06:01 Epoch: 39, loss: 1.3636, lr: 0.00000955
2025-12-17 16:11:26 train acc=0.923125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06292431640625, 0.0, 0.9629248046875, 0.2847940673828125, 4.96085546875]
2025-12-17 16:11:26 Epoch: 40, loss: 1.3603, lr: 0.00000778
2025-12-17 16:16:51 train acc=0.926125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06365570068359375, 0.0, 0.96209228515625, 0.283501220703125, 4.95314453125]
2025-12-17 16:16:51 Epoch: 41, loss: 1.3588, lr: 0.00000618
2025-12-17 16:22:15 train acc=0.92325, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06374835205078125, 0.0, 0.95858251953125, 0.2882659912109375, 4.9607421875]
2025-12-17 16:22:15 Epoch: 42, loss: 1.3602, lr: 0.00000476
2025-12-17 16:27:39 train acc=0.9256875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0638447265625, 0.0, 0.95750634765625, 0.28412109375, 4.9561875]
2025-12-17 16:27:39 Epoch: 43, loss: 1.3550, lr: 0.00000351
2025-12-17 16:33:04 train acc=0.92275, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06412939453125, 0.0, 0.96033740234375, 0.28587451171875, 4.9560703125]
2025-12-17 16:33:04 Epoch: 44, loss: 1.3599, lr: 0.00000245
2025-12-17 16:38:29 train acc=0.926125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06418780517578125, 0.0, 0.95457080078125, 0.2823909912109375, 4.95534765625]
2025-12-17 16:38:29 Epoch: 45, loss: 1.3507, lr: 0.00000157
2025-12-17 16:43:54 train acc=0.9248125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0641148681640625, 0.0, 0.9532626953125, 0.2836043701171875, 4.96405078125]
2025-12-17 16:43:54 Epoch: 46, loss: 1.3506, lr: 0.00000089
2025-12-17 16:49:19 train acc=0.9235, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06416412353515626, 0.0, 0.9529404296875, 0.2842821044921875, 4.9683203125]
2025-12-17 16:49:19 Epoch: 47, loss: 1.3511, lr: 0.00000039
2025-12-17 16:54:43 train acc=0.927375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.064231201171875, 0.0, 0.9509794921875, 0.283746826171875, 4.9500234375]
2025-12-17 16:54:43 Epoch: 48, loss: 1.3484, lr: 0.00000010
2025-12-17 17:00:08 train acc=0.924125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0642645263671875, 0.0, 0.95405126953125, 0.28149267578125, 4.95487109375]
2025-12-17 17:00:08 Epoch: 49, loss: 1.3493, lr: 0.00000000
2025-12-17 17:12:12 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 67.634, 'GLR_logits': 70.998, 'final_logits': 70.292, 'acc': 73.238}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-17 17:12:12 avg clip_logits acc=68.77
2025-12-17 17:12:12 avg cma_logits acc=67.634
2025-12-17 17:12:12 avg GLR_logits acc=70.998
2025-12-17 17:12:12 avg final_logits acc=70.292
2025-12-17 17:12:12 avg acc acc=73.238
