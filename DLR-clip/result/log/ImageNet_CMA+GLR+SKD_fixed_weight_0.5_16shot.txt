2025-12-20 00:17:41 Preparing ViT-B/16 model.
2025-12-20 00:17:47 Getting cached textual weights W ...
2025-12-20 00:17:47 Initializing CMA adapter learner...
2025-12-20 00:17:48 Initializing SKD distillation...
2025-12-20 00:17:48 Preparing imagenet dataset.
2025-12-20 00:23:43 train acc=0.709625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0007757141590118409, 0.0, 1.11486572265625, 1.06376220703125, 0.6623125]
2025-12-20 00:23:43 Epoch: 0, loss: 2.1860, lr: 0.00009990
2025-12-20 00:29:09 train acc=0.7279375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0017691707611083983, 0.0, 1.1198076171875, 0.98305517578125, 0.8476796875]
2025-12-20 00:29:09 Epoch: 1, loss: 2.1131, lr: 0.00009961
2025-12-20 00:34:33 train acc=0.743375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.00216563606262207, 0.0, 1.11898974609375, 0.923199951171875, 1.06301953125]
2025-12-20 00:34:33 Epoch: 2, loss: 2.0550, lr: 0.00009911
2025-12-20 00:39:57 train acc=0.7585625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0020851402282714843, 0.0, 1.114251953125, 0.86199658203125, 1.26568359375]
2025-12-20 00:39:57 Epoch: 3, loss: 1.9910, lr: 0.00009843
2025-12-20 00:45:20 train acc=0.7703125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.002114267349243164, 0.0, 1.116345703125, 0.8056025390625, 1.532162109375]
2025-12-20 00:45:20 Epoch: 4, loss: 1.9394, lr: 0.00009755
2025-12-20 00:50:44 train acc=0.783125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.002225409984588623, 0.0, 1.12009228515625, 0.75592822265625, 1.8396796875]
2025-12-20 00:50:44 Epoch: 5, loss: 1.8966, lr: 0.00009649
2025-12-20 00:56:07 train acc=0.7985625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0027716941833496093, 0.0, 1.1151318359375, 0.701264892578125, 2.1368671875]
2025-12-20 00:56:07 Epoch: 6, loss: 1.8405, lr: 0.00009524
2025-12-20 01:01:28 train acc=0.8118125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0036552162170410156, 0.0, 1.1161904296875, 0.655531494140625, 2.37505859375]
2025-12-20 01:01:28 Epoch: 7, loss: 1.7991, lr: 0.00009382
2025-12-20 01:06:50 train acc=0.818875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.005294387817382813, 0.0, 1.1148447265625, 0.61332275390625, 2.6474609375]
2025-12-20 01:06:50 Epoch: 8, loss: 1.7599, lr: 0.00009222
2025-12-20 01:12:15 train acc=0.8321875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.008115699768066406, 0.0, 1.1073427734375, 0.573544677734375, 2.83210546875]
2025-12-20 01:12:15 Epoch: 9, loss: 1.7174, lr: 0.00009045
2025-12-20 01:17:40 train acc=0.8444375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.012478302001953125, 0.0, 1.0980146484375, 0.539921630859375, 3.02152734375]
2025-12-20 01:17:40 Epoch: 10, loss: 1.6806, lr: 0.00008853
2025-12-20 01:23:04 train acc=0.848875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.017651870727539064, 0.0, 1.09251953125, 0.5116678466796875, 3.13916015625]
2025-12-20 01:23:04 Epoch: 11, loss: 1.6532, lr: 0.00008645
2025-12-20 01:28:27 train acc=0.8585625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.024124114990234376, 0.0, 1.07327294921875, 0.48325, 3.371515625]
2025-12-20 01:28:27 Epoch: 12, loss: 1.6144, lr: 0.00008423
2025-12-20 01:33:51 train acc=0.8666875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.031376800537109374, 0.0, 1.05403564453125, 0.45972509765625, 3.4776171875]
2025-12-20 01:33:51 Epoch: 13, loss: 1.5799, lr: 0.00008187
2025-12-20 01:39:13 train acc=0.87775, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03933892822265625, 0.0, 1.023162109375, 0.4366622314453125, 3.57986328125]
2025-12-20 01:39:13 Epoch: 14, loss: 1.5350, lr: 0.00007939
2025-12-20 01:44:35 train acc=0.8821875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04698809814453125, 0.0, 0.99725390625, 0.41606494140625, 3.6811484375]
2025-12-20 01:44:35 Epoch: 15, loss: 1.4971, lr: 0.00007679
2025-12-20 01:49:56 train acc=0.8848125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0556689453125, 0.0, 0.96596728515625, 0.39948486328125, 3.778078125]
2025-12-20 01:49:56 Epoch: 16, loss: 1.4589, lr: 0.00007409
2025-12-20 01:55:17 train acc=0.893625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0648818359375, 0.0, 0.91991845703125, 0.3766641845703125, 3.82808203125]
2025-12-20 01:55:17 Epoch: 17, loss: 1.3997, lr: 0.00007129
2025-12-20 02:00:39 train acc=0.9014375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0739176025390625, 0.0, 0.88260888671875, 0.3621024169921875, 3.8828828125]
2025-12-20 02:00:39 Epoch: 18, loss: 1.3574, lr: 0.00006841
2025-12-20 02:06:00 train acc=0.9070625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.082916748046875, 0.0, 0.84492236328125, 0.343538818359375, 3.9303203125]
2025-12-20 02:06:00 Epoch: 19, loss: 1.3107, lr: 0.00006545
2025-12-20 02:11:21 train acc=0.9101875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.09206201171875, 0.0, 0.807541015625, 0.3312779541015625, 3.96016796875]
2025-12-20 02:11:21 Epoch: 20, loss: 1.2705, lr: 0.00006243
2025-12-20 02:16:42 train acc=0.9154375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1011815185546875, 0.0, 0.76836962890625, 0.3174307861328125, 4.0106875]
2025-12-20 02:16:42 Epoch: 21, loss: 1.2271, lr: 0.00005937
2025-12-20 02:22:03 train acc=0.921625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1098057861328125, 0.0, 0.7223056640625, 0.2975604248046875, 4.02911328125]
2025-12-20 02:22:03 Epoch: 22, loss: 1.1700, lr: 0.00005627
2025-12-20 02:27:25 train acc=0.9250625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.11776953125, 0.0, 0.68567041015625, 0.2865750732421875, 4.04337109375]
2025-12-20 02:27:25 Epoch: 23, loss: 1.1304, lr: 0.00005314
2025-12-20 02:32:46 train acc=0.93075, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.12582666015625, 0.0, 0.64601025390625, 0.27322723388671877, 4.081765625]
2025-12-20 02:32:46 Epoch: 24, loss: 1.0859, lr: 0.00005000
2025-12-20 02:38:07 train acc=0.93225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1335931396484375, 0.0, 0.613187744140625, 0.2647391357421875, 4.10424609375]
2025-12-20 02:38:07 Epoch: 25, loss: 1.0526, lr: 0.00004686
2025-12-20 02:43:28 train acc=0.9410625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.140537841796875, 0.0, 0.5824384765625, 0.24993658447265624, 4.11271484375]
2025-12-20 02:43:28 Epoch: 26, loss: 1.0141, lr: 0.00004373
2025-12-20 02:48:49 train acc=0.9426875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.147273193359375, 0.0, 0.550660888671875, 0.2431365966796875, 4.14952734375]
2025-12-20 02:48:49 Epoch: 27, loss: 0.9826, lr: 0.00004063
2025-12-20 02:54:11 train acc=0.9436875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.153091064453125, 0.0, 0.523619384765625, 0.2331995849609375, 4.1658125]
2025-12-20 02:54:11 Epoch: 28, loss: 0.9516, lr: 0.00003757
2025-12-20 02:59:32 train acc=0.9463125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1585927734375, 0.0, 0.5016103515625, 0.22434722900390625, 4.1652109375]
2025-12-20 02:59:32 Epoch: 29, loss: 0.9262, lr: 0.00003455
2025-12-20 03:04:53 train acc=0.9511875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.163360595703125, 0.0, 0.478704345703125, 0.21666650390625, 4.187484375]
2025-12-20 03:04:53 Epoch: 30, loss: 0.9006, lr: 0.00003159
2025-12-20 03:10:14 train acc=0.95275, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.167880859375, 0.0, 0.454854736328125, 0.21123333740234376, 4.2075859375]
2025-12-20 03:10:14 Epoch: 31, loss: 0.8761, lr: 0.00002871
2025-12-20 03:15:35 train acc=0.955625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.172086181640625, 0.0, 0.4383480224609375, 0.20617120361328126, 4.21910546875]
2025-12-20 03:15:35 Epoch: 32, loss: 0.8588, lr: 0.00002591
2025-12-20 03:20:57 train acc=0.957625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.175480224609375, 0.0, 0.4207335205078125, 0.1972506103515625, 4.22790234375]
2025-12-20 03:20:57 Epoch: 33, loss: 0.8357, lr: 0.00002321
2025-12-20 03:26:18 train acc=0.9585625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1782841796875, 0.0, 0.4028199462890625, 0.19495703125, 4.2413984375]
2025-12-20 03:26:18 Epoch: 34, loss: 0.8185, lr: 0.00002061
2025-12-20 03:31:39 train acc=0.9605, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.18123046875, 0.0, 0.3928809814453125, 0.19238275146484374, 4.25112890625]
2025-12-20 03:31:39 Epoch: 35, loss: 0.8090, lr: 0.00001813
2025-12-20 03:37:00 train acc=0.9610625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.18321435546875, 0.0, 0.3803458251953125, 0.1868472900390625, 4.25980078125]
2025-12-20 03:37:00 Epoch: 36, loss: 0.7930, lr: 0.00001577
2025-12-20 03:42:21 train acc=0.9610625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.185565673828125, 0.0, 0.375344970703125, 0.18568109130859375, 4.26178125]
2025-12-20 03:42:21 Epoch: 37, loss: 0.7892, lr: 0.00001355
2025-12-20 03:47:43 train acc=0.964, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.18724853515625, 0.0, 0.364627685546875, 0.1808162841796875, 4.2706328125]
2025-12-20 03:47:43 Epoch: 38, loss: 0.7754, lr: 0.00001147
2025-12-20 03:53:04 train acc=0.9638125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.188310791015625, 0.0, 0.35607275390625, 0.1800338134765625, 4.279421875]
2025-12-20 03:53:04 Epoch: 39, loss: 0.7672, lr: 0.00000955
2025-12-20 03:58:25 train acc=0.96575, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.189306640625, 0.0, 0.3504383544921875, 0.17691827392578124, 4.27848828125]
2025-12-20 03:58:25 Epoch: 40, loss: 0.7594, lr: 0.00000778
2025-12-20 04:03:46 train acc=0.9649375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1903603515625, 0.0, 0.34614599609375, 0.17612738037109374, 4.2785703125]
2025-12-20 04:03:46 Epoch: 41, loss: 0.7554, lr: 0.00000618
2025-12-20 04:09:07 train acc=0.965875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.19153662109375, 0.0, 0.3414949951171875, 0.17574609375, 4.288515625]
2025-12-20 04:09:07 Epoch: 42, loss: 0.7517, lr: 0.00000476
2025-12-20 04:14:28 train acc=0.967625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.19173779296875, 0.0, 0.3366387939453125, 0.17275335693359375, 4.2885]
2025-12-20 04:14:28 Epoch: 43, loss: 0.7440, lr: 0.00000351
2025-12-20 04:19:49 train acc=0.9659375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.19213623046875, 0.0, 0.3377779541015625, 0.17344696044921876, 4.29077734375]
2025-12-20 04:19:49 Epoch: 44, loss: 0.7463, lr: 0.00000245
2025-12-20 04:25:10 train acc=0.967625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.192434814453125, 0.0, 0.3315634765625, 0.17131610107421874, 4.29524609375]
2025-12-20 04:25:10 Epoch: 45, loss: 0.7383, lr: 0.00000157
2025-12-20 04:30:31 train acc=0.966875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.192349609375, 0.0, 0.331105712890625, 0.17141168212890626, 4.30258984375]
2025-12-20 04:30:31 Epoch: 46, loss: 0.7379, lr: 0.00000089
2025-12-20 04:35:52 train acc=0.966625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.192503173828125, 0.0, 0.3294722900390625, 0.170687744140625, 4.29954296875]
2025-12-20 04:35:52 Epoch: 47, loss: 0.7356, lr: 0.00000039
2025-12-20 04:41:14 train acc=0.966375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.192536376953125, 0.0, 0.3303662109375, 0.17192474365234375, 4.2936796875]
2025-12-20 04:41:14 Epoch: 48, loss: 0.7378, lr: 0.00000010
2025-12-20 04:46:35 train acc=0.9654375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.192701904296875, 0.0, 0.3297218017578125, 0.168726806640625, 4.2913203125]
2025-12-20 04:46:35 Epoch: 49, loss: 0.7340, lr: 0.00000000
2025-12-20 05:01:58 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 62.916000000000004, 'GLR_logits': 72.564, 'final_logits': 70.348, 'acc': 73.41}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-20 05:01:58 avg clip_logits acc=68.77
2025-12-20 05:01:58 avg cma_logits acc=62.916000000000004
2025-12-20 05:01:58 avg GLR_logits acc=72.564
2025-12-20 05:01:58 avg final_logits acc=70.348
2025-12-20 05:01:58 avg acc acc=73.41
