2025-12-17 08:14:39 Preparing ViT-B/16 model.
2025-12-17 08:14:41 Getting cached textual weights W ...
2025-12-17 08:14:41 Initializing CMA adapter learner...
2025-12-17 08:14:42 Preparing imagenet dataset.
2025-12-17 08:19:35 train acc=0.704875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.9156689453125, 0.0013994286060333252, 1.3142353515625, 1.11472021484375, 1.09934130859375]
2025-12-17 08:19:35 Epoch: 0, loss: 4.4454, lr: 0.00009990
2025-12-17 08:24:29 train acc=0.7141875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.769123046875, 0.002811647415161133, 1.1967060546875, 1.118921875, 1.05709423828125]
2025-12-17 08:24:29 Epoch: 1, loss: 4.1446, lr: 0.00009961
2025-12-17 08:29:22 train acc=0.72225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7195263671875, 0.0030980205535888674, 1.1048232421875, 1.11839306640625, 1.015005859375]
2025-12-17 08:29:22 Epoch: 2, loss: 3.9609, lr: 0.00009911
2025-12-17 08:34:15 train acc=0.736625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7032109375, 0.0026606273651123046, 1.03020361328125, 1.11425146484375, 0.966288330078125]
2025-12-17 08:34:15 Epoch: 3, loss: 3.8166, lr: 0.00009843
2025-12-17 08:39:08 train acc=0.745125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7013037109375, 0.0029507465362548827, 0.975486328125, 1.11544873046875, 0.92577880859375]
2025-12-17 08:39:08 Epoch: 4, loss: 3.7210, lr: 0.00009755
2025-12-17 08:44:01 train acc=0.750875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.70297265625, 0.003542858123779297, 0.9342626953125, 1.11867333984375, 0.89436376953125]
2025-12-17 08:44:01 Epoch: 5, loss: 3.6538, lr: 0.00009649
2025-12-17 08:48:54 train acc=0.76125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.708150390625, 0.004150917053222656, 0.89713818359375, 1.1137265625, 0.86234033203125]
2025-12-17 08:48:54 Epoch: 6, loss: 3.5855, lr: 0.00009524
2025-12-17 08:53:47 train acc=0.7676875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7140126953125, 0.004963233947753907, 0.86633056640625, 1.11463134765625, 0.83453955078125]
2025-12-17 08:53:47 Epoch: 7, loss: 3.5345, lr: 0.00009382
2025-12-17 08:58:40 train acc=0.77225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.719052734375, 0.006065238952636718, 0.84009423828125, 1.11402734375, 0.81257861328125]
2025-12-17 08:58:40 Epoch: 8, loss: 3.4918, lr: 0.00009222
2025-12-17 09:03:33 train acc=0.780875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.72541015625, 0.007154541015625, 0.811623046875, 1.1093505859375, 0.785087890625]
2025-12-17 09:03:33 Epoch: 9, loss: 3.4386, lr: 0.00009045
2025-12-17 09:08:26 train acc=0.7875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7293974609375, 0.00842060089111328, 0.7918056640625, 1.10571875, 0.7658154296875]
2025-12-17 09:08:26 Epoch: 10, loss: 3.4011, lr: 0.00008853
2025-12-17 09:13:19 train acc=0.790625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.73234765625, 0.009914543151855469, 0.7777158203125, 1.10856982421875, 0.752321044921875]
2025-12-17 09:13:19 Epoch: 11, loss: 3.3808, lr: 0.00008645
2025-12-17 09:18:13 train acc=0.7949375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7397021484375, 0.011257537841796875, 0.756217041015625, 1.10386083984375, 0.7326630859375]
2025-12-17 09:18:13 Epoch: 12, loss: 3.3437, lr: 0.00008423
2025-12-17 09:23:06 train acc=0.798625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7442861328125, 0.012775558471679688, 0.73907470703125, 1.10282421875, 0.7162080078125]
2025-12-17 09:23:06 Epoch: 13, loss: 3.3152, lr: 0.00008187
2025-12-17 09:27:59 train acc=0.804375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.74653125, 0.01421722412109375, 0.725090087890625, 1.09567138671875, 0.70220849609375]
2025-12-17 09:27:59 Epoch: 14, loss: 3.2837, lr: 0.00007939
2025-12-17 09:32:52 train acc=0.806375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.751740234375, 0.014805908203125, 0.71240576171875, 1.09871044921875, 0.69086865234375]
2025-12-17 09:32:52 Epoch: 15, loss: 3.2685, lr: 0.00007679
2025-12-17 09:37:46 train acc=0.8086875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7538212890625, 0.015546943664550781, 0.705123291015625, 1.10009619140625, 0.68421533203125]
2025-12-17 09:37:46 Epoch: 16, loss: 3.2587, lr: 0.00007409
2025-12-17 09:42:39 train acc=0.813125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.75852734375, 0.01687266540527344, 0.68763232421875, 1.0877548828125, 0.666854248046875]
2025-12-17 09:42:39 Epoch: 17, loss: 3.2177, lr: 0.00007129
2025-12-17 09:47:32 train acc=0.8165, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7612548828125, 0.018037872314453127, 0.680075927734375, 1.0860810546875, 0.659457275390625]
2025-12-17 09:47:32 Epoch: 18, loss: 3.2049, lr: 0.00006841
2025-12-17 09:52:25 train acc=0.819125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7649306640625, 0.01975846862792969, 0.66992236328125, 1.0872333984375, 0.65013525390625]
2025-12-17 09:52:25 Epoch: 19, loss: 3.1919, lr: 0.00006545
2025-12-17 09:57:18 train acc=0.8213125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.766708984375, 0.019978515625, 0.66610986328125, 1.08934326171875, 0.646620361328125]
2025-12-17 09:57:18 Epoch: 20, loss: 3.1888, lr: 0.00006243
2025-12-17 10:02:11 train acc=0.823, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7698603515625, 0.02087176513671875, 0.6601787109375, 1.08761865234375, 0.641032958984375]
2025-12-17 10:02:11 Epoch: 21, loss: 3.1795, lr: 0.00005937
2025-12-17 10:07:05 train acc=0.825, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.772025390625, 0.021700042724609375, 0.650282470703125, 1.079853515625, 0.6310419921875]
2025-12-17 10:07:05 Epoch: 22, loss: 3.1549, lr: 0.00005627
2025-12-17 10:11:58 train acc=0.8266875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.772705078125, 0.02284844970703125, 0.640734130859375, 1.0803291015625, 0.62122900390625]
2025-12-17 10:11:58 Epoch: 23, loss: 3.1378, lr: 0.00005314
2025-12-17 10:16:51 train acc=0.8315625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7750498046875, 0.02363818359375, 0.634044921875, 1.0733818359375, 0.615883544921875]
2025-12-17 10:16:51 Epoch: 24, loss: 3.1220, lr: 0.00005000
2025-12-17 10:21:44 train acc=0.8309375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.776099609375, 0.02471223449707031, 0.635523193359375, 1.0748359375, 0.6165244140625]
2025-12-17 10:21:44 Epoch: 25, loss: 3.1277, lr: 0.00004686
2025-12-17 10:26:37 train acc=0.8329375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.777083984375, 0.025772857666015624, 0.628194580078125, 1.07437109375, 0.609827880859375]
2025-12-17 10:26:37 Epoch: 26, loss: 3.1152, lr: 0.00004373
2025-12-17 10:31:30 train acc=0.8338125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7782763671875, 0.026175048828125, 0.624513916015625, 1.07155029296875, 0.60627978515625]
2025-12-17 10:31:30 Epoch: 27, loss: 3.1067, lr: 0.00004063
2025-12-17 10:36:23 train acc=0.837, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7796884765625, 0.02692529296875, 0.619365234375, 1.0687158203125, 0.600501220703125]
2025-12-17 10:36:23 Epoch: 28, loss: 3.0951, lr: 0.00003757
2025-12-17 10:41:16 train acc=0.8369375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7811103515625, 0.027659088134765624, 0.617884765625, 1.07138916015625, 0.598990478515625]
2025-12-17 10:41:16 Epoch: 29, loss: 3.0970, lr: 0.00003455
2025-12-17 10:46:09 train acc=0.8360625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7827236328125, 0.027949005126953124, 0.61609326171875, 1.0709111328125, 0.597142578125]
2025-12-17 10:46:09 Epoch: 30, loss: 3.0948, lr: 0.00003159
2025-12-17 10:51:02 train acc=0.8414375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.782326171875, 0.028694854736328126, 0.611603271484375, 1.0634150390625, 0.592810302734375]
2025-12-17 10:51:02 Epoch: 31, loss: 3.0789, lr: 0.00002871
2025-12-17 10:55:55 train acc=0.8388125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.783064453125, 0.029325439453125, 0.611314453125, 1.06582080078125, 0.592154052734375]
2025-12-17 10:55:55 Epoch: 32, loss: 3.0816, lr: 0.00002591
2025-12-17 11:00:48 train acc=0.837625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.782822265625, 0.02937115478515625, 0.61035302734375, 1.0632509765625, 0.591353759765625]
2025-12-17 11:00:48 Epoch: 33, loss: 3.0772, lr: 0.00002321
2025-12-17 11:05:41 train acc=0.842375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7825615234375, 0.02979388427734375, 0.60379443359375, 1.054513671875, 0.58493798828125]
2025-12-17 11:05:41 Epoch: 34, loss: 3.0556, lr: 0.00002061
2025-12-17 11:10:35 train acc=0.840125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.78359375, 0.03062548828125, 0.60930029296875, 1.060255859375, 0.589394775390625]
2025-12-17 11:10:35 Epoch: 35, loss: 3.0731, lr: 0.00001813
2025-12-17 11:15:28 train acc=0.8398125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7840810546875, 0.030257049560546874, 0.60486083984375, 1.05789892578125, 0.585589111328125]
2025-12-17 11:15:28 Epoch: 36, loss: 3.0627, lr: 0.00001577
2025-12-17 11:20:21 train acc=0.839625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7831826171875, 0.03021728515625, 0.60974462890625, 1.064775390625, 0.59066015625]
2025-12-17 11:20:21 Epoch: 37, loss: 3.0786, lr: 0.00001355
2025-12-17 11:25:14 train acc=0.842625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7842216796875, 0.0306875, 0.605007080078125, 1.0581611328125, 0.585142578125]
2025-12-17 11:25:14 Epoch: 38, loss: 3.0632, lr: 0.00001147
2025-12-17 11:30:07 train acc=0.8433125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7834404296875, 0.03095623779296875, 0.606254638671875, 1.05500146484375, 0.58624267578125]
2025-12-17 11:30:07 Epoch: 39, loss: 3.0619, lr: 0.00000955
2025-12-17 11:35:00 train acc=0.8415, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7836875, 0.0309927978515625, 0.603518310546875, 1.0559365234375, 0.584414794921875]
2025-12-17 11:35:00 Epoch: 40, loss: 3.0585, lr: 0.00000778
2025-12-17 11:39:53 train acc=0.8433125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.784013671875, 0.031217315673828124, 0.602785400390625, 1.056994140625, 0.58302685546875]
2025-12-17 11:39:53 Epoch: 41, loss: 3.0580, lr: 0.00000618
2025-12-17 11:44:46 train acc=0.84275, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.783669921875, 0.03143826293945313, 0.607634765625, 1.0544560546875, 0.5871015625]
2025-12-17 11:44:46 Epoch: 42, loss: 3.0642, lr: 0.00000476
2025-12-17 11:49:39 train acc=0.8406875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.78431640625, 0.03161669921875, 0.604765380859375, 1.05421142578125, 0.5852353515625]
2025-12-17 11:49:39 Epoch: 43, loss: 3.0601, lr: 0.00000351
2025-12-17 11:54:32 train acc=0.842625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7836806640625, 0.0313236083984375, 0.605894775390625, 1.05775537109375, 0.5856962890625]
2025-12-17 11:54:32 Epoch: 44, loss: 3.0643, lr: 0.00000245
2025-12-17 11:59:25 train acc=0.8438125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7837724609375, 0.03160604858398437, 0.603589111328125, 1.05222802734375, 0.5834130859375]
2025-12-17 11:59:25 Epoch: 45, loss: 3.0547, lr: 0.00000157
2025-12-17 12:04:18 train acc=0.842875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.783771484375, 0.031274017333984376, 0.602522705078125, 1.0509248046875, 0.582957275390625]
2025-12-17 12:04:18 Epoch: 46, loss: 3.0515, lr: 0.00000089
2025-12-17 12:09:11 train acc=0.8414375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.783671875, 0.03140350341796875, 0.604465576171875, 1.0514931640625, 0.584239501953125]
2025-12-17 12:09:11 Epoch: 47, loss: 3.0554, lr: 0.00000039
2025-12-17 12:14:04 train acc=0.84175, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7833193359375, 0.031679595947265625, 0.60384912109375, 1.04943505859375, 0.5839267578125]
2025-12-17 12:14:04 Epoch: 48, loss: 3.0522, lr: 0.00000010
2025-12-17 12:18:57 train acc=0.839375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3] => [0.7837919921875, 0.03156085205078125, 0.60133984375, 1.0529501953125, 0.58155712890625]
2025-12-17 12:18:57 Epoch: 49, loss: 3.0512, lr: 0.00000000
2025-12-17 12:30:53 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 71.514, 'GLR_logits': 69.838, 'final_logits': 72.24000000000001, 'acc': 72.682}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-17 12:30:53 avg clip_logits acc=68.77
2025-12-17 12:30:53 avg cma_logits acc=71.514
2025-12-17 12:30:53 avg GLR_logits acc=69.838
2025-12-17 12:30:53 avg final_logits acc=72.24000000000001
2025-12-17 12:30:53 avg acc acc=72.682
