2025-12-17 03:35:18 Preparing ViT-B/16 model.
2025-12-17 03:35:20 Getting cached textual weights W ...
2025-12-17 03:35:20 Initializing CMA adapter learner...
2025-12-17 03:35:20 Initializing SKD distillation...
2025-12-17 03:35:20 Preparing imagenet dataset.
2025-12-17 03:40:44 train acc=0.672875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.9703720703125, 0.0, 1.30883154296875, 1.3088583984375, 0.98246484375]
2025-12-17 03:40:44 Epoch: 0, loss: 3.5979, lr: 0.00009990
2025-12-17 03:46:04 train acc=0.6935625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.85537109375, 0.0, 1.18352490234375, 1.18350439453125, 0.9389111328125]
2025-12-17 03:46:04 Epoch: 1, loss: 3.2318, lr: 0.00009961
2025-12-17 03:51:25 train acc=0.7095625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8173212890625, 0.0, 1.09706201171875, 1.09707666015625, 0.935080078125]
2025-12-17 03:51:25 Epoch: 2, loss: 3.0208, lr: 0.00009911
2025-12-17 03:56:46 train acc=0.7236875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7909287109375, 0.0, 1.02862841796875, 1.02865673828125, 0.9448701171875]
2025-12-17 03:56:46 Epoch: 3, loss: 2.8577, lr: 0.00009843
2025-12-17 04:02:06 train acc=0.7325, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.776208984375, 0.0, 0.9799609375, 0.97994482421875, 0.9623564453125]
2025-12-17 04:02:06 Epoch: 4, loss: 2.7458, lr: 0.00009755
2025-12-17 04:07:26 train acc=0.7415, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7662158203125, 0.0, 0.9420947265625, 0.94210205078125, 0.9785966796875]
2025-12-17 04:07:26 Epoch: 5, loss: 2.6603, lr: 0.00009649
2025-12-17 04:12:47 train acc=0.7489375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.763150390625, 0.0, 0.9065830078125, 0.9065830078125, 1.0017021484375]
2025-12-17 04:12:47 Epoch: 6, loss: 2.5863, lr: 0.00009524
2025-12-17 04:18:07 train acc=0.7535625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.762953125, 0.0, 0.87625830078125, 0.87625927734375, 1.0177373046875]
2025-12-17 04:18:07 Epoch: 7, loss: 2.5256, lr: 0.00009382
2025-12-17 04:23:28 train acc=0.758875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7641357421875, 0.0, 0.85043212890625, 0.85047265625, 1.031533203125]
2025-12-17 04:23:28 Epoch: 8, loss: 2.4753, lr: 0.00009222
2025-12-17 04:28:48 train acc=0.7686875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7665185546875, 0.0, 0.8214921875, 0.8214736328125, 1.0554443359375]
2025-12-17 04:28:48 Epoch: 9, loss: 2.4200, lr: 0.00009045
2025-12-17 04:34:09 train acc=0.7766875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.76699609375, 0.0, 0.80234765625, 0.80236865234375, 1.07553125]
2025-12-17 04:34:09 Epoch: 10, loss: 2.3825, lr: 0.00008853
2025-12-17 04:39:29 train acc=0.776125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.76776953125, 0.0, 0.7883759765625, 0.788337158203125, 1.0736845703125]
2025-12-17 04:39:29 Epoch: 11, loss: 2.3552, lr: 0.00008645
2025-12-17 04:44:49 train acc=0.7834375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7729462890625, 0.0, 0.766235107421875, 0.766212890625, 1.1041904296875]
2025-12-17 04:44:49 Epoch: 12, loss: 2.3164, lr: 0.00008423
2025-12-17 04:50:10 train acc=0.788625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7748779296875, 0.0, 0.75097119140625, 0.75102587890625, 1.1124560546875]
2025-12-17 04:50:10 Epoch: 13, loss: 2.2881, lr: 0.00008187
2025-12-17 04:55:30 train acc=0.7925625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.775783203125, 0.0, 0.73544580078125, 0.73543798828125, 1.1204375]
2025-12-17 04:55:30 Epoch: 14, loss: 2.2579, lr: 0.00007939
2025-12-17 05:00:51 train acc=0.7956875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.78030078125, 0.0, 0.72277783203125, 0.722783203125, 1.144876953125]
2025-12-17 05:00:51 Epoch: 15, loss: 2.2373, lr: 0.00007679
2025-12-17 05:06:12 train acc=0.7955, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.77997265625, 0.0, 0.7176005859375, 0.7176142578125, 1.141884765625]
2025-12-17 05:06:12 Epoch: 16, loss: 2.2266, lr: 0.00007409
2025-12-17 05:11:32 train acc=0.80225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7838056640625, 0.0, 0.69902001953125, 0.69906689453125, 1.1593828125]
2025-12-17 05:11:32 Epoch: 17, loss: 2.1935, lr: 0.00007129
2025-12-17 05:16:52 train acc=0.806625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7853447265625, 0.0, 0.69194189453125, 0.691951171875, 1.166109375]
2025-12-17 05:16:53 Epoch: 18, loss: 2.1810, lr: 0.00006841
2025-12-17 05:22:13 train acc=0.807125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7879306640625, 0.0, 0.68324072265625, 0.6832177734375, 1.177703125]
2025-12-17 05:22:13 Epoch: 19, loss: 2.1662, lr: 0.00006545
2025-12-17 05:27:33 train acc=0.8113125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7883994140625, 0.0, 0.6785869140625, 0.6785712890625, 1.176892578125]
2025-12-17 05:27:33 Epoch: 20, loss: 2.1573, lr: 0.00006243
2025-12-17 05:32:54 train acc=0.810625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.791681640625, 0.0, 0.67294189453125, 0.6729453125, 1.1891630859375]
2025-12-17 05:32:54 Epoch: 21, loss: 2.1495, lr: 0.00005937
2025-12-17 05:38:14 train acc=0.8135, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7929697265625, 0.0, 0.663318115234375, 0.66333642578125, 1.1951904296875]
2025-12-17 05:38:14 Epoch: 22, loss: 2.1316, lr: 0.00005627
2025-12-17 05:43:35 train acc=0.8149375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.792953125, 0.0, 0.6547080078125, 0.65471826171875, 1.198705078125]
2025-12-17 05:43:35 Epoch: 23, loss: 2.1144, lr: 0.00005314
2025-12-17 05:48:55 train acc=0.819125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.794650390625, 0.0, 0.647917236328125, 0.647973876953125, 1.2076083984375]
2025-12-17 05:48:55 Epoch: 24, loss: 2.1026, lr: 0.00005000
2025-12-17 05:54:16 train acc=0.817625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7956083984375, 0.0, 0.649482666015625, 0.649500244140625, 1.2151396484375]
2025-12-17 05:54:16 Epoch: 25, loss: 2.1067, lr: 0.00004686
2025-12-17 05:59:36 train acc=0.820375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7961748046875, 0.0, 0.642185791015625, 0.64220947265625, 1.209251953125]
2025-12-17 05:59:36 Epoch: 26, loss: 2.0927, lr: 0.00004373
2025-12-17 06:04:57 train acc=0.8225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7966396484375, 0.0, 0.6389755859375, 0.63899462890625, 1.2157880859375]
2025-12-17 06:04:57 Epoch: 27, loss: 2.0868, lr: 0.00004063
2025-12-17 06:10:17 train acc=0.8233125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7978876953125, 0.0, 0.6333486328125, 0.6334091796875, 1.2245048828125]
2025-12-17 06:10:17 Epoch: 28, loss: 2.0769, lr: 0.00003757
2025-12-17 06:15:37 train acc=0.823125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.7988642578125, 0.0, 0.63289599609375, 0.63284033203125, 1.22678515625]
2025-12-17 06:15:37 Epoch: 29, loss: 2.0769, lr: 0.00003455
2025-12-17 06:20:58 train acc=0.8234375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.80059375, 0.0, 0.630359375, 0.63039111328125, 1.23380859375]
2025-12-17 06:20:58 Epoch: 30, loss: 2.0737, lr: 0.00003159
2025-12-17 06:26:18 train acc=0.825125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.799802734375, 0.0, 0.62591259765625, 0.6259375, 1.2319765625]
2025-12-17 06:26:18 Epoch: 31, loss: 2.0640, lr: 0.00002871
2025-12-17 06:31:39 train acc=0.826125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.80054296875, 0.0, 0.626513427734375, 0.62650244140625, 1.23490625]
2025-12-17 06:31:39 Epoch: 32, loss: 2.0659, lr: 0.00002591
2025-12-17 06:36:59 train acc=0.825125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8000673828125, 0.0, 0.625428466796875, 0.625423583984375, 1.23215625]
2025-12-17 06:36:59 Epoch: 33, loss: 2.0633, lr: 0.00002321
2025-12-17 06:42:20 train acc=0.8281875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.799625, 0.0, 0.619202392578125, 0.61924462890625, 1.2324765625]
2025-12-17 06:42:20 Epoch: 34, loss: 2.0503, lr: 0.00002061
2025-12-17 06:47:40 train acc=0.826125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.800482421875, 0.0, 0.623653564453125, 0.62367431640625, 1.23628515625]
2025-12-17 06:47:40 Epoch: 35, loss: 2.0601, lr: 0.00001813
2025-12-17 06:53:00 train acc=0.8261875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.801056640625, 0.0, 0.619127197265625, 0.6191435546875, 1.2394453125]
2025-12-17 06:53:00 Epoch: 36, loss: 2.0517, lr: 0.00001577
2025-12-17 06:58:21 train acc=0.8285625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.800076171875, 0.0, 0.624416748046875, 0.62441552734375, 1.23569921875]
2025-12-17 06:58:21 Epoch: 37, loss: 2.0613, lr: 0.00001355
2025-12-17 07:03:41 train acc=0.8290625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8014111328125, 0.0, 0.619410400390625, 0.61941064453125, 1.23981640625]
2025-12-17 07:03:41 Epoch: 38, loss: 2.0526, lr: 0.00001147
2025-12-17 07:09:02 train acc=0.826875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8007119140625, 0.0, 0.62134619140625, 0.621371337890625, 1.2372861328125]
2025-12-17 07:09:02 Epoch: 39, loss: 2.0558, lr: 0.00000955
2025-12-17 07:14:22 train acc=0.82775, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8009716796875, 0.0, 0.6184970703125, 0.61846826171875, 1.2385546875]
2025-12-17 07:14:22 Epoch: 40, loss: 2.0503, lr: 0.00000778
2025-12-17 07:19:42 train acc=0.8305, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.80093359375, 0.0, 0.6181923828125, 0.618207275390625, 1.237025390625]
2025-12-17 07:19:42 Epoch: 41, loss: 2.0496, lr: 0.00000618
2025-12-17 07:25:03 train acc=0.8269375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.800814453125, 0.0, 0.621718017578125, 0.621744140625, 1.239470703125]
2025-12-17 07:25:03 Epoch: 42, loss: 2.0567, lr: 0.00000476
2025-12-17 07:30:23 train acc=0.8268125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8012451171875, 0.0, 0.618855224609375, 0.618890380859375, 1.239361328125]
2025-12-17 07:30:23 Epoch: 43, loss: 2.0514, lr: 0.00000351
2025-12-17 07:35:44 train acc=0.82625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8008330078125, 0.0, 0.621035888671875, 0.621088134765625, 1.240708984375]
2025-12-17 07:35:44 Epoch: 44, loss: 2.0553, lr: 0.00000245
2025-12-17 07:41:04 train acc=0.829625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.801076171875, 0.0, 0.61863427734375, 0.61868701171875, 1.238314453125]
2025-12-17 07:41:04 Epoch: 45, loss: 2.0507, lr: 0.00000157
2025-12-17 07:46:25 train acc=0.828125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8011083984375, 0.0, 0.61720849609375, 0.6172431640625, 1.2393046875]
2025-12-17 07:46:25 Epoch: 46, loss: 2.0480, lr: 0.00000089
2025-12-17 07:51:45 train acc=0.827, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8008515625, 0.0, 0.61949609375, 0.6194892578125, 1.2384609375]
2025-12-17 07:51:45 Epoch: 47, loss: 2.0522, lr: 0.00000039
2025-12-17 07:57:06 train acc=0.828, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8004951171875, 0.0, 0.618380859375, 0.61842138671875, 1.2365234375]
2025-12-17 07:57:06 Epoch: 48, loss: 2.0496, lr: 0.00000010
2025-12-17 08:02:26 train acc=0.8254375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.8006865234375, 0.0, 0.6153525390625, 0.61536328125, 1.2394921875]
2025-12-17 08:02:26 Epoch: 49, loss: 2.0438, lr: 0.00000000
2025-12-17 08:14:27 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 71.64399999999999, 'GLR_logits': 68.77, 'final_logits': 72.074, 'acc': 72.53}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-17 08:14:27 avg clip_logits acc=68.77
2025-12-17 08:14:27 avg cma_logits acc=71.64399999999999
2025-12-17 08:14:27 avg GLR_logits acc=68.77
2025-12-17 08:14:27 avg final_logits acc=72.074
2025-12-17 08:14:27 avg acc acc=72.53
