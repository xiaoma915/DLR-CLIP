2025-12-19 19:07:39 Preparing ViT-B/16 model.
2025-12-19 19:07:41 Getting cached textual weights W ...
2025-12-19 19:07:41 Initializing CMA adapter learner...
2025-12-19 19:07:42 Initializing SKD distillation...
2025-12-19 19:07:42 Preparing imagenet dataset.
2025-12-19 19:09:06 Preparing ViT-B/16 model.
2025-12-19 19:09:09 Getting cached textual weights W ...
2025-12-19 19:09:09 Initializing CMA adapter learner...
2025-12-19 19:09:09 Initializing SKD distillation...
2025-12-19 19:09:09 Preparing imagenet dataset.
2025-12-19 19:11:33 Preparing ViT-B/16 model.
2025-12-19 19:11:35 Getting cached textual weights W ...
2025-12-19 19:11:35 Initializing CMA adapter learner...
2025-12-19 19:11:35 Initializing SKD distillation...
2025-12-19 19:11:35 Preparing imagenet dataset.
2025-12-19 19:14:52 Preparing ViT-B/16 model.
2025-12-19 19:14:54 Getting cached textual weights W ...
2025-12-19 19:14:54 Initializing CMA adapter learner...
2025-12-19 19:14:55 Initializing SKD distillation...
2025-12-19 19:14:55 Preparing imagenet dataset.
2025-12-19 19:21:39 train acc=0.6994375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0019107983112335205, 0.0, 1.114595703125, 1.114595703125, 0.5190712890625]
2025-12-19 19:21:39 Epoch: 0, loss: 2.2364, lr: 0.00009990
2025-12-19 19:27:04 train acc=0.6978125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0042284088134765625, 0.0, 1.11838671875, 1.11838671875, 0.51906982421875]
2025-12-19 19:27:04 Epoch: 1, loss: 2.2462, lr: 0.00009961
2025-12-19 19:32:30 train acc=0.69625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.00466502571105957, 0.0, 1.1181826171875, 1.1181826171875, 0.51962158203125]
2025-12-19 19:32:30 Epoch: 2, loss: 2.2462, lr: 0.00009911
2025-12-19 19:37:55 train acc=0.699875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.007118820190429687, 0.0, 1.111408203125, 1.111408203125, 0.51928076171875]
2025-12-19 19:37:55 Epoch: 3, loss: 2.2352, lr: 0.00009843
2025-12-19 19:43:19 train acc=0.69825, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.010661537170410157, 0.0, 1.110849609375, 1.110849609375, 0.51798046875]
2025-12-19 19:43:19 Epoch: 4, loss: 2.2376, lr: 0.00009755
2025-12-19 19:48:45 train acc=0.69925, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.011346351623535157, 0.0, 1.11526123046875, 1.11526123046875, 0.518548828125]
2025-12-19 19:48:45 Epoch: 5, loss: 2.2471, lr: 0.00009649
2025-12-19 19:54:09 train acc=0.6995625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.016008956909179688, 0.0, 1.10577197265625, 1.10577197265625, 0.51785107421875]
2025-12-19 19:54:09 Epoch: 6, loss: 2.2328, lr: 0.00009524
2025-12-19 19:59:34 train acc=0.70025, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.020981399536132813, 0.0, 1.10263623046875, 1.10263623046875, 0.51717724609375]
2025-12-19 19:59:34 Epoch: 7, loss: 2.2315, lr: 0.00009382
2025-12-19 20:05:00 train acc=0.7064375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.025089767456054686, 0.0, 1.10102880859375, 1.10102880859375, 0.51781591796875]
2025-12-19 20:05:00 Epoch: 8, loss: 2.2324, lr: 0.00009222
2025-12-19 20:10:25 train acc=0.704375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.027487503051757813, 0.0, 1.095763671875, 1.095763671875, 0.51841015625]
2025-12-19 20:10:25 Epoch: 9, loss: 2.2242, lr: 0.00009045
2025-12-19 20:15:50 train acc=0.7070625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.031605224609375, 0.0, 1.08899462890625, 1.08899462890625, 0.51846142578125]
2025-12-19 20:15:50 Epoch: 10, loss: 2.2149, lr: 0.00008853
2025-12-19 20:21:15 train acc=0.7046875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03670303344726562, 0.0, 1.0883173828125, 1.0883173828125, 0.519615234375]
2025-12-19 20:21:15 Epoch: 11, loss: 2.2186, lr: 0.00008645
2025-12-19 20:26:40 train acc=0.7075625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04107147216796875, 0.0, 1.07948193359375, 1.07948193359375, 0.52105517578125]
2025-12-19 20:26:40 Epoch: 12, loss: 2.2053, lr: 0.00008423
2025-12-19 20:32:05 train acc=0.7115625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04606585693359375, 0.0, 1.06684521484375, 1.06684521484375, 0.52231689453125]
2025-12-19 20:32:05 Epoch: 13, loss: 2.1850, lr: 0.00008187
2025-12-19 20:37:31 train acc=0.7210625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05271539306640625, 0.0, 1.03574169921875, 1.03574169921875, 0.525267578125]
2025-12-19 20:37:31 Epoch: 14, loss: 2.1295, lr: 0.00007939
2025-12-19 20:42:55 train acc=0.7285625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.06191278076171875, 0.0, 1.003802734375, 1.003802734375, 0.53335400390625]
2025-12-19 20:42:55 Epoch: 15, loss: 2.0749, lr: 0.00007679
2025-12-19 20:48:21 train acc=0.7410625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0733365478515625, 0.0, 0.963310546875, 0.963310546875, 0.544529296875]
2025-12-19 20:48:21 Epoch: 16, loss: 2.0055, lr: 0.00007409
2025-12-19 20:53:46 train acc=0.756625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0863675537109375, 0.0, 0.9059580078125, 0.9059580078125, 0.55955712890625]
2025-12-19 20:53:46 Epoch: 17, loss: 1.9040, lr: 0.00007129
2025-12-19 20:59:11 train acc=0.7736875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0993070068359375, 0.0, 0.85739306640625, 0.85739306640625, 0.576845703125]
2025-12-19 20:59:11 Epoch: 18, loss: 1.8199, lr: 0.00006841
2025-12-19 21:04:36 train acc=0.789375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1130299072265625, 0.0, 0.80719775390625, 0.80719775390625, 0.59628369140625]
2025-12-19 21:04:36 Epoch: 19, loss: 1.7334, lr: 0.00006545
2025-12-19 21:10:01 train acc=0.8045, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1266807861328125, 0.0, 0.75718798828125, 0.75718798828125, 0.617462890625]
2025-12-19 21:10:01 Epoch: 20, loss: 1.6472, lr: 0.00006243
2025-12-19 21:15:26 train acc=0.8246875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.140427490234375, 0.0, 0.706373291015625, 0.706373291015625, 0.64070654296875]
2025-12-19 21:15:26 Epoch: 21, loss: 1.5596, lr: 0.00005937
2025-12-19 21:20:51 train acc=0.843, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.153928466796875, 0.0, 0.6492001953125, 0.6492001953125, 0.66530078125]
2025-12-19 21:20:51 Epoch: 22, loss: 1.4590, lr: 0.00005627
2025-12-19 21:26:16 train acc=0.8578125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.16603369140625, 0.0, 0.60222216796875, 0.60222216796875, 0.6891083984375]
2025-12-19 21:26:16 Epoch: 23, loss: 1.3774, lr: 0.00005314
2025-12-19 21:31:41 train acc=0.8728125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1786943359375, 0.0, 0.555177490234375, 0.555177490234375, 0.7189560546875]
2025-12-19 21:31:41 Epoch: 24, loss: 1.2962, lr: 0.00005000
2025-12-19 21:37:06 train acc=0.884625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.1901103515625, 0.0, 0.514241455078125, 0.514241455078125, 0.745982421875]
2025-12-19 21:37:06 Epoch: 25, loss: 1.2261, lr: 0.00004686
2025-12-19 21:42:31 train acc=0.8985, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.200920166015625, 0.0, 0.476585205078125, 0.476585205078125, 0.7727353515625]
2025-12-19 21:42:31 Epoch: 26, loss: 1.1618, lr: 0.00004373
2025-12-19 21:47:56 train acc=0.908, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.21130859375, 0.0, 0.44026708984375, 0.44026708984375, 0.79934765625]
2025-12-19 21:47:56 Epoch: 27, loss: 1.0998, lr: 0.00004063
2025-12-19 21:53:21 train acc=0.9205, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.2199345703125, 0.0, 0.407681640625, 0.407681640625, 0.828291015625]
2025-12-19 21:53:21 Epoch: 28, loss: 1.0436, lr: 0.00003757
2025-12-19 21:58:46 train acc=0.9279375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.22823974609375, 0.0, 0.3818499755859375, 0.3818499755859375, 0.850125]
2025-12-19 21:58:46 Epoch: 29, loss: 1.0004, lr: 0.00003455
2025-12-19 22:04:11 train acc=0.93425, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.235647705078125, 0.0, 0.3561412353515625, 0.3561412353515625, 0.87575390625]
2025-12-19 22:04:11 Epoch: 30, loss: 0.9567, lr: 0.00003159
2025-12-19 22:09:37 train acc=0.942, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.242344970703125, 0.0, 0.331007568359375, 0.331007568359375, 0.8976083984375]
2025-12-19 22:09:37 Epoch: 31, loss: 0.9133, lr: 0.00002871
2025-12-19 22:15:02 train acc=0.9479375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.24831640625, 0.0, 0.312799560546875, 0.312799560546875, 0.920337890625]
2025-12-19 22:15:02 Epoch: 32, loss: 0.8831, lr: 0.00002591
2025-12-19 22:20:27 train acc=0.9530625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.253162109375, 0.0, 0.294461669921875, 0.294461669921875, 0.9401767578125]
2025-12-19 22:20:27 Epoch: 33, loss: 0.8515, lr: 0.00002321
2025-12-19 22:25:52 train acc=0.9585625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.257376708984375, 0.0, 0.2762998046875, 0.2762998046875, 0.95438671875]
2025-12-19 22:25:52 Epoch: 34, loss: 0.8195, lr: 0.00002061
2025-12-19 22:31:17 train acc=0.9593125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.26152490234375, 0.0, 0.2663470458984375, 0.2663470458984375, 0.9731259765625]
2025-12-19 22:31:17 Epoch: 35, loss: 0.8040, lr: 0.00001813
2025-12-19 22:36:43 train acc=0.962875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.264652587890625, 0.0, 0.253757080078125, 0.253757080078125, 0.989123046875]
2025-12-19 22:36:43 Epoch: 36, loss: 0.7820, lr: 0.00001577
2025-12-19 22:42:07 train acc=0.9644375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.26752392578125, 0.0, 0.2477838134765625, 0.2477838134765625, 0.999748046875]
2025-12-19 22:42:08 Epoch: 37, loss: 0.7731, lr: 0.00001355
2025-12-19 22:47:32 train acc=0.9655, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.26994287109375, 0.0, 0.2374715576171875, 0.2374715576171875, 1.011677734375]
2025-12-19 22:47:32 Epoch: 38, loss: 0.7550, lr: 0.00001147
2025-12-19 22:52:57 train acc=0.9699375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.27177099609375, 0.0, 0.2292462158203125, 0.2292462158203125, 1.0215146484375]
2025-12-19 22:52:57 Epoch: 39, loss: 0.7405, lr: 0.00000955
2025-12-19 22:58:22 train acc=0.9694375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.27318115234375, 0.0, 0.223083251953125, 0.223083251953125, 1.0290185546875]
2025-12-19 22:58:22 Epoch: 40, loss: 0.7296, lr: 0.00000778
2025-12-19 23:03:47 train acc=0.972125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.274458984375, 0.0, 0.21929150390625, 0.21929150390625, 1.03548828125]
2025-12-19 23:03:47 Epoch: 41, loss: 0.7234, lr: 0.00000618
2025-12-19 23:09:12 train acc=0.9726875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.275703125, 0.0, 0.2157628173828125, 0.2157628173828125, 1.04446484375]
2025-12-19 23:09:12 Epoch: 42, loss: 0.7177, lr: 0.00000476
2025-12-19 23:14:37 train acc=0.97475, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.27637060546875, 0.0, 0.2119071044921875, 0.2119071044921875, 1.046806640625]
2025-12-19 23:14:37 Epoch: 43, loss: 0.7107, lr: 0.00000351
2025-12-19 23:20:02 train acc=0.9736875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.27696044921875, 0.0, 0.21080126953125, 0.21080126953125, 1.0488232421875]
2025-12-19 23:20:02 Epoch: 44, loss: 0.7090, lr: 0.00000245
2025-12-19 23:25:27 train acc=0.9745, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.27720947265625, 0.0, 0.20687255859375, 0.20687255859375, 1.05192578125]
2025-12-19 23:25:27 Epoch: 45, loss: 0.7015, lr: 0.00000157
2025-12-19 23:30:52 train acc=0.9755, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.27742822265625, 0.0, 0.2056807861328125, 0.2056807861328125, 1.0553359375]
2025-12-19 23:30:52 Epoch: 46, loss: 0.6993, lr: 0.00000089
2025-12-19 23:36:17 train acc=0.9755625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.27751171875, 0.0, 0.205181396484375, 0.205181396484375, 1.053673828125]
2025-12-19 23:36:17 Epoch: 47, loss: 0.6984, lr: 0.00000039
2025-12-19 23:41:42 train acc=0.974625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.277623046875, 0.0, 0.2048919677734375, 0.2048919677734375, 1.055064453125]
2025-12-19 23:41:42 Epoch: 48, loss: 0.6980, lr: 0.00000010
2025-12-19 23:47:07 train acc=0.976125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.2776328125, 0.0, 0.2033929443359375, 0.2033929443359375, 1.0546904296875]
2025-12-19 23:47:07 Epoch: 49, loss: 0.6950, lr: 0.00000000
2025-12-20 00:05:33 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 58.611999999999995, 'GLR_logits': 72.54599999999999, 'final_logits': 67.41, 'acc': 72.83}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-20 00:05:33 avg clip_logits acc=68.77
2025-12-20 00:05:33 avg cma_logits acc=58.611999999999995
2025-12-20 00:05:33 avg GLR_logits acc=72.54599999999999
2025-12-20 00:05:33 avg final_logits acc=67.41
2025-12-20 00:05:33 avg acc acc=72.83
