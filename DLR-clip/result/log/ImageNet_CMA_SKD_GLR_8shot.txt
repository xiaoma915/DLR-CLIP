2025-12-19 00:29:52 Preparing ViT-B/16 model.
2025-12-19 00:29:57 Getting cached textual weights W ...
2025-12-19 00:29:57 Initializing CMA adapter learner...
2025-12-19 00:29:57 Initializing SKD distillation...
2025-12-19 00:29:57 Preparing imagenet dataset.
2025-12-19 00:36:37 train acc=0.707125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0003127446174621582, 0.0, 1.1151748046875, 1.096630859375, 0.5956240234375]
2025-12-19 00:36:37 Epoch: 0, loss: 2.2180, lr: 0.00009990
2025-12-19 00:39:20 train acc=0.721, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0019231338500976562, 0.0, 1.1217236328125, 1.0186015625, 0.785234375]
2025-12-19 00:39:20 Epoch: 1, loss: 2.1500, lr: 0.00009961
2025-12-19 00:42:03 train acc=0.735375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0021998157501220703, 0.0, 1.113923828125, 0.95395703125, 0.970572265625]
2025-12-19 00:42:03 Epoch: 2, loss: 2.0797, lr: 0.00009911
2025-12-19 00:44:46 train acc=0.750625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.002571052551269531, 0.0, 1.10866015625, 0.8895986328125, 1.172154296875]
2025-12-19 00:44:46 Epoch: 3, loss: 2.0125, lr: 0.00009843
2025-12-19 00:47:28 train acc=0.763625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0029166030883789064, 0.0, 1.1184921875, 0.83500927734375, 1.4557265625]
2025-12-19 00:47:28 Epoch: 4, loss: 1.9711, lr: 0.00009755
2025-12-19 00:50:11 train acc=0.78625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.00307830810546875, 0.0, 1.1109912109375, 0.761560546875, 1.7380703125]
2025-12-19 00:50:11 Epoch: 5, loss: 1.8930, lr: 0.00009649
2025-12-19 00:52:54 train acc=0.802875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0034373207092285155, 0.0, 1.1138994140625, 0.69865234375, 2.01790625]
2025-12-19 00:52:54 Epoch: 6, loss: 1.8362, lr: 0.00009524
2025-12-19 00:55:37 train acc=0.82025, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.004140480041503906, 0.0, 1.114109375, 0.64053125, 2.350359375]
2025-12-19 00:55:37 Epoch: 7, loss: 1.7823, lr: 0.00009382
2025-12-19 00:58:20 train acc=0.836, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.004946601867675781, 0.0, 1.1141982421875, 0.5852939453125, 2.62825]
2025-12-19 00:58:20 Epoch: 8, loss: 1.7307, lr: 0.00009222
2025-12-19 01:01:03 train acc=0.8485, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.006248336791992187, 0.0, 1.1099150390625, 0.53669873046875, 2.9312890625]
2025-12-19 01:01:03 Epoch: 9, loss: 1.6822, lr: 0.00009045
2025-12-19 01:03:46 train acc=0.863125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.007833694458007813, 0.0, 1.100681640625, 0.48842431640625, 3.2333359375]
2025-12-19 01:03:46 Epoch: 10, loss: 1.6292, lr: 0.00008853
2025-12-19 01:06:29 train acc=0.87625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.01010333251953125, 0.0, 1.1034169921875, 0.4501943359375, 3.464609375]
2025-12-19 01:06:29 Epoch: 11, loss: 1.5984, lr: 0.00008645
2025-12-19 01:09:12 train acc=0.88575, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.012949981689453126, 0.0, 1.098720703125, 0.414067626953125, 3.7691640625]
2025-12-19 01:09:12 Epoch: 12, loss: 1.5635, lr: 0.00008423
2025-12-19 01:11:55 train acc=0.898875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.01592510986328125, 0.0, 1.0891103515625, 0.376176513671875, 3.973234375]
2025-12-19 01:11:55 Epoch: 13, loss: 1.5210, lr: 0.00008187
2025-12-19 01:14:38 train acc=0.9055, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.019693359375, 0.0, 1.0850693359375, 0.3592598876953125, 4.2241953125]
2025-12-19 01:14:38 Epoch: 14, loss: 1.5063, lr: 0.00007939
2025-12-19 01:17:20 train acc=0.91175, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.02383331298828125, 0.0, 1.08363671875, 0.33834326171875, 4.34015625]
2025-12-19 01:17:20 Epoch: 15, loss: 1.4893, lr: 0.00007679
2025-12-19 01:20:03 train acc=0.9165, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.027805908203125, 0.0, 1.063970703125, 0.317258056640625, 4.5171484375]
2025-12-19 01:20:03 Epoch: 16, loss: 1.4542, lr: 0.00007409
2025-12-19 01:22:46 train acc=0.927375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03185528564453125, 0.0, 1.0506025390625, 0.296908203125, 4.6280390625]
2025-12-19 01:22:46 Epoch: 17, loss: 1.4257, lr: 0.00007129
2025-12-19 01:25:29 train acc=0.928875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.035964599609375, 0.0, 1.042572265625, 0.280962646484375, 4.738703125]
2025-12-19 01:25:29 Epoch: 18, loss: 1.4069, lr: 0.00006841
2025-12-19 01:28:12 train acc=0.935875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0400155029296875, 0.0, 1.0291337890625, 0.2712740478515625, 4.8266171875]
2025-12-19 01:28:12 Epoch: 19, loss: 1.3887, lr: 0.00006545
2025-12-19 01:30:55 train acc=0.940625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0442691650390625, 0.0, 1.0143681640625, 0.25384375, 4.938859375]
2025-12-19 01:30:55 Epoch: 20, loss: 1.3618, lr: 0.00006243
2025-12-19 01:33:37 train acc=0.938875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0482489013671875, 0.0, 0.9958369140625, 0.2473974609375, 4.986796875]
2025-12-19 01:33:37 Epoch: 21, loss: 1.3414, lr: 0.00005937
2025-12-19 01:36:21 train acc=0.943, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.052195068359375, 0.0, 0.9809462890625, 0.239757080078125, 5.092828125]
2025-12-19 01:36:21 Epoch: 22, loss: 1.3238, lr: 0.00005627
2025-12-19 01:39:03 train acc=0.9445, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.055872802734375, 0.0, 0.9696904296875, 0.2299525146484375, 5.140734375]
2025-12-19 01:39:03 Epoch: 23, loss: 1.3069, lr: 0.00005314
2025-12-19 01:41:46 train acc=0.94775, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0595181884765625, 0.0, 0.9574521484375, 0.2234608154296875, 5.140015625]
2025-12-19 01:41:46 Epoch: 24, loss: 1.2918, lr: 0.00005000
2025-12-19 01:44:29 train acc=0.94825, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0630328369140625, 0.0, 0.9509619140625, 0.2206866455078125, 5.1501875]
2025-12-19 01:44:29 Epoch: 25, loss: 1.2862, lr: 0.00004686
2025-12-19 01:47:12 train acc=0.952125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.066208251953125, 0.0, 0.931380859375, 0.2109097900390625, 5.193734375]
2025-12-19 01:47:12 Epoch: 26, loss: 1.2604, lr: 0.00004373
2025-12-19 01:49:55 train acc=0.95625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0693843994140625, 0.0, 0.91397265625, 0.20439599609375, 5.1861875]
2025-12-19 01:49:55 Epoch: 27, loss: 1.2396, lr: 0.00004063
2025-12-19 01:52:38 train acc=0.956875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.072047119140625, 0.0, 0.903669921875, 0.198977294921875, 5.209140625]
2025-12-19 01:52:38 Epoch: 28, loss: 1.2268, lr: 0.00003757
2025-12-19 01:55:21 train acc=0.95875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.074786865234375, 0.0, 0.889099609375, 0.1940107421875, 5.251140625]
2025-12-19 01:55:21 Epoch: 29, loss: 1.2104, lr: 0.00003455
2025-12-19 01:58:04 train acc=0.956875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0770654296875, 0.0, 0.878181640625, 0.19579296875, 5.20515625]
2025-12-19 01:58:04 Epoch: 30, loss: 1.2031, lr: 0.00003159
2025-12-19 02:00:46 train acc=0.959875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.079330810546875, 0.0, 0.8684912109375, 0.193452880859375, 5.224859375]
2025-12-19 02:00:46 Epoch: 31, loss: 1.1935, lr: 0.00002871
2025-12-19 02:03:29 train acc=0.959875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.081424560546875, 0.0, 0.855474609375, 0.188298828125, 5.18878125]
2025-12-19 02:03:29 Epoch: 32, loss: 1.1771, lr: 0.00002591
2025-12-19 02:06:12 train acc=0.96275, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.082961181640625, 0.0, 0.8542333984375, 0.188885498046875, 5.1849765625]
2025-12-19 02:06:12 Epoch: 33, loss: 1.1780, lr: 0.00002321
2025-12-19 02:08:55 train acc=0.960375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.08476220703125, 0.0, 0.840099609375, 0.185502685546875, 5.189921875]
2025-12-19 02:08:55 Epoch: 34, loss: 1.1623, lr: 0.00002061
2025-12-19 02:11:37 train acc=0.9605, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.08593115234375, 0.0, 0.82687890625, 0.18688720703125, 5.175609375]
2025-12-19 02:11:37 Epoch: 35, loss: 1.1514, lr: 0.00001813
2025-12-19 02:14:20 train acc=0.96225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.08720068359375, 0.0, 0.8210537109375, 0.1825540771484375, 5.199859375]
2025-12-19 02:14:20 Epoch: 36, loss: 1.1428, lr: 0.00001577
2025-12-19 02:17:03 train acc=0.96325, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.088223388671875, 0.0, 0.8220244140625, 0.181739990234375, 5.159640625]
2025-12-19 02:17:03 Epoch: 37, loss: 1.1436, lr: 0.00001355
2025-12-19 02:19:46 train acc=0.96475, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.089169921875, 0.0, 0.81317578125, 0.1787952880859375, 5.15075]
2025-12-19 02:19:46 Epoch: 38, loss: 1.1327, lr: 0.00001147
2025-12-19 02:22:28 train acc=0.963375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.090018798828125, 0.0, 0.8155751953125, 0.181893798828125, 5.16146875]
2025-12-19 02:22:28 Epoch: 39, loss: 1.1391, lr: 0.00000955
2025-12-19 02:25:11 train acc=0.963625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.090715576171875, 0.0, 0.8071376953125, 0.1791741943359375, 5.1508125]
2025-12-19 02:25:11 Epoch: 40, loss: 1.1285, lr: 0.00000778
2025-12-19 02:27:53 train acc=0.9625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.091097900390625, 0.0, 0.804359375, 0.1815040283203125, 5.155640625]
2025-12-19 02:27:53 Epoch: 41, loss: 1.1286, lr: 0.00000618
2025-12-19 02:30:36 train acc=0.964125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.091799072265625, 0.0, 0.8009130859375, 0.1813402099609375, 5.14759375]
2025-12-19 02:30:36 Epoch: 42, loss: 1.1255, lr: 0.00000476
2025-12-19 02:33:19 train acc=0.965875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.091743896484375, 0.0, 0.7988505859375, 0.17516357421875, 5.1446875]
2025-12-19 02:33:19 Epoch: 43, loss: 1.1172, lr: 0.00000351
2025-12-19 02:36:01 train acc=0.967125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0920458984375, 0.0, 0.78726953125, 0.1742041015625, 5.15903125]
2025-12-19 02:36:01 Epoch: 44, loss: 1.1051, lr: 0.00000245
2025-12-19 02:38:44 train acc=0.96375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.09217138671875, 0.0, 0.7933662109375, 0.179149169921875, 5.16015625]
2025-12-19 02:38:44 Epoch: 45, loss: 1.1163, lr: 0.00000157
2025-12-19 02:41:27 train acc=0.964375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.092333984375, 0.0, 0.8036650390625, 0.1835946044921875, 5.153609375]
2025-12-19 02:41:27 Epoch: 46, loss: 1.1311, lr: 0.00000089
2025-12-19 02:44:10 train acc=0.96375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.092474609375, 0.0, 0.7950283203125, 0.181105712890625, 5.14484375]
2025-12-19 02:44:10 Epoch: 47, loss: 1.1200, lr: 0.00000039
2025-12-19 02:46:53 train acc=0.964125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.092505859375, 0.0, 0.7928720703125, 0.18274853515625, 5.135609375]
2025-12-19 02:46:53 Epoch: 48, loss: 1.1195, lr: 0.00000010
2025-12-19 02:49:36 train acc=0.96575, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.09250537109375, 0.0, 0.792798828125, 0.18243310546875, 5.1677734375]
2025-12-19 02:49:36 Epoch: 49, loss: 1.1194, lr: 0.00000000
2025-12-19 03:20:10 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 66.134, 'GLR_logits': 71.14200000000001, 'final_logits': 69.312, 'acc': 72.63199999999999}, {'clip_logits': 69.17999999999999, 'cma_logits': 64.86, 'GLR_logits': 71.15, 'final_logits': 67.89, 'acc': 72.08}, {'clip_logits': 48.383737153412326, 'cma_logits': 41.79488691072727, 'GLR_logits': 48.80033013028356, 'final_logits': 43.887677101141705, 'acc': 49.04792784295231}], 'detail': 'dataset_name=imagenet, shots=8, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-19 03:20:10   ImageNet测试结果: {'clip_logits': 68.77, 'cma_logits': 66.134, 'GLR_logits': 71.14200000000001, 'final_logits': 69.312, 'acc': 72.63199999999999}
2025-12-19 03:20:10   ImageNet-V2测试结果: {'clip_logits': 69.17999999999999, 'cma_logits': 64.86, 'GLR_logits': 71.15, 'final_logits': 67.89, 'acc': 72.08}
2025-12-19 03:20:10   ImageNet-Sketch测试结果: {'clip_logits': 48.383737153412326, 'cma_logits': 41.79488691072727, 'GLR_logits': 48.80033013028356, 'final_logits': 43.887677101141705, 'acc': 49.04792784295231}
2025-12-19 03:20:10 avg clip_logits acc=62.1112457178041
2025-12-19 03:20:10 avg cma_logits acc=57.5962956369091
2025-12-19 03:20:10 avg GLR_logits acc=63.69744337676119
2025-12-19 03:20:10 avg final_logits acc=60.363225700380575
2025-12-19 03:20:10 avg acc acc=64.58664261431743
