2025-12-17 17:12:21 Preparing ViT-B/16 model.
2025-12-17 17:12:23 Getting cached textual weights W ...
2025-12-17 17:12:23 Initializing CMA adapter learner...
2025-12-17 17:12:23 Initializing SKD distillation...
2025-12-17 17:12:23 Preparing imagenet dataset.
2025-12-17 17:17:49 train acc=0.7103125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.001125922441482544, 0.0, 1.11478369140625, 1.06863330078125, 0.6589326171875]
2025-12-17 17:17:49 Epoch: 0, loss: 2.1911, lr: 0.00009990
2025-12-17 17:23:36 train acc=0.7245625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0021364898681640624, 0.0, 1.1192626953125, 0.9939345703125, 0.829919921875]
2025-12-17 17:23:37 Epoch: 1, loss: 2.1236, lr: 0.00009961
2025-12-17 17:29:30 train acc=0.738375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0023206939697265625, 0.0, 1.11890283203125, 0.94125341796875, 0.9822802734375]
2025-12-17 17:29:30 Epoch: 2, loss: 2.0723, lr: 0.00009911
2025-12-17 17:35:23 train acc=0.7513125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0020801000595092774, 0.0, 1.1146123046875, 0.88207568359375, 1.17428515625]
2025-12-17 17:35:23 Epoch: 3, loss: 2.0105, lr: 0.00009843
2025-12-17 17:41:16 train acc=0.7653125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0021507277488708497, 0.0, 1.11632958984375, 0.8234501953125, 1.45196484375]
2025-12-17 17:41:16 Epoch: 4, loss: 1.9564, lr: 0.00009755
2025-12-17 17:47:08 train acc=0.779875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.002345123291015625, 0.0, 1.11999267578125, 0.767485595703125, 1.759208984375]
2025-12-17 17:47:08 Epoch: 5, loss: 1.9075, lr: 0.00009649
2025-12-17 17:53:01 train acc=0.796875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0025281791687011717, 0.0, 1.1154755859375, 0.706802001953125, 2.068626953125]
2025-12-17 17:53:01 Epoch: 6, loss: 1.8455, lr: 0.00009524
2025-12-17 17:58:53 train acc=0.81075, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0029352912902832033, 0.0, 1.11705859375, 0.6538798828125, 2.341091796875]
2025-12-17 17:58:53 Epoch: 7, loss: 1.7973, lr: 0.00009382
2025-12-17 18:04:44 train acc=0.8244375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.003360616683959961, 0.0, 1.11756201171875, 0.60529345703125, 2.65701953125]
2025-12-17 18:04:44 Epoch: 8, loss: 1.7528, lr: 0.00009222
2025-12-17 18:10:33 train acc=0.8385625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.004121267318725586, 0.0, 1.113255859375, 0.561220703125, 2.91005078125]
2025-12-17 18:10:33 Epoch: 9, loss: 1.7078, lr: 0.00009045
2025-12-17 18:16:26 train acc=0.8468125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0055105934143066405, 0.0, 1.109966796875, 0.526220458984375, 3.23001171875]
2025-12-17 18:16:26 Epoch: 10, loss: 1.6740, lr: 0.00008853
2025-12-17 18:22:21 train acc=0.854875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.006963973999023438, 0.0, 1.11283740234375, 0.49850830078125, 3.40271484375]
2025-12-17 18:22:21 Epoch: 11, loss: 1.6524, lr: 0.00008645
2025-12-17 18:28:14 train acc=0.864125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.008935020446777344, 0.0, 1.10748095703125, 0.467899658203125, 3.635203125]
2025-12-17 18:28:14 Epoch: 12, loss: 1.6207, lr: 0.00008423
2025-12-17 18:33:55 train acc=0.8741875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.011100078582763672, 0.0, 1.10556689453125, 0.445416748046875, 3.79794921875]
2025-12-17 18:33:55 Epoch: 13, loss: 1.6001, lr: 0.00008187
2025-12-17 18:39:22 train acc=0.881, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.013467605590820313, 0.0, 1.09568017578125, 0.42523046875, 3.93026171875]
2025-12-17 18:39:22 Epoch: 14, loss: 1.5737, lr: 0.00007939
2025-12-17 18:44:46 train acc=0.88525, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.01552545166015625, 0.0, 1.09730810546875, 0.4094412841796875, 4.06663671875]
2025-12-17 18:44:46 Epoch: 15, loss: 1.5630, lr: 0.00007679
2025-12-17 18:50:11 train acc=0.886875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.017860565185546875, 0.0, 1.09581103515625, 0.3953570556640625, 4.2184140625]
2025-12-17 18:50:11 Epoch: 16, loss: 1.5512, lr: 0.00007409
2025-12-17 18:55:36 train acc=0.8929375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.02041156005859375, 0.0, 1.0812294921875, 0.3755699462890625, 4.3363515625]
2025-12-17 18:55:36 Epoch: 17, loss: 1.5206, lr: 0.00007129
2025-12-17 19:01:01 train acc=0.89825, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.02332171630859375, 0.0, 1.07627978515625, 0.3692000732421875, 4.45383984375]
2025-12-17 19:01:01 Epoch: 18, loss: 1.5133, lr: 0.00006841
2025-12-17 19:06:26 train acc=0.902375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.025938858032226564, 0.0, 1.07431591796875, 0.3563897705078125, 4.52978515625]
2025-12-17 19:06:26 Epoch: 19, loss: 1.5020, lr: 0.00006545
2025-12-17 19:11:51 train acc=0.9040625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.028623748779296875, 0.0, 1.07127880859375, 0.347692626953125, 4.60170703125]
2025-12-17 19:11:51 Epoch: 20, loss: 1.4936, lr: 0.00006243
2025-12-17 19:17:15 train acc=0.90475, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0313004150390625, 0.0, 1.0657939453125, 0.34139111328125, 4.70080859375]
2025-12-17 19:17:15 Epoch: 21, loss: 1.4855, lr: 0.00005937
2025-12-17 19:22:41 train acc=0.91025, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03379452514648437, 0.0, 1.053859375, 0.330624267578125, 4.7256953125]
2025-12-17 19:22:41 Epoch: 22, loss: 1.4656, lr: 0.00005627
2025-12-17 19:28:06 train acc=0.910875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0361015625, 0.0, 1.05028271484375, 0.3257987060546875, 4.75469921875]
2025-12-17 19:28:06 Epoch: 23, loss: 1.4597, lr: 0.00005314
2025-12-17 19:33:31 train acc=0.912625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.03829644775390625, 0.0, 1.0401884765625, 0.3177208251953125, 4.85043359375]
2025-12-17 19:33:31 Epoch: 24, loss: 1.4447, lr: 0.00005000
2025-12-17 19:38:56 train acc=0.9121875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04068048095703125, 0.0, 1.03656396484375, 0.3187489013671875, 4.84405078125]
2025-12-17 19:38:56 Epoch: 25, loss: 1.4444, lr: 0.00004686
2025-12-17 19:44:21 train acc=0.916875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04292193603515625, 0.0, 1.032490234375, 0.3076563720703125, 4.89951953125]
2025-12-17 19:44:21 Epoch: 26, loss: 1.4321, lr: 0.00004373
2025-12-17 19:49:46 train acc=0.9155, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0448223876953125, 0.0, 1.02641552734375, 0.30662939453125, 4.95575390625]
2025-12-17 19:49:46 Epoch: 27, loss: 1.4274, lr: 0.00004063
2025-12-17 19:55:11 train acc=0.9180625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04683477783203125, 0.0, 1.01919140625, 0.3005723876953125, 4.96933203125]
2025-12-17 19:55:11 Epoch: 28, loss: 1.4163, lr: 0.00003757
2025-12-17 20:00:36 train acc=0.91825, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.048572509765625, 0.0, 1.01866259765625, 0.2995721435546875, 4.9595859375]
2025-12-17 20:00:36 Epoch: 29, loss: 1.4164, lr: 0.00003455
2025-12-17 20:06:01 train acc=0.9200625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0499456787109375, 0.0, 1.01388671875, 0.2967635498046875, 4.978515625]
2025-12-17 20:06:01 Epoch: 30, loss: 1.4104, lr: 0.00003159
2025-12-17 20:11:26 train acc=0.919875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05133978271484375, 0.0, 1.00413671875, 0.2946624755859375, 4.9906015625]
2025-12-17 20:11:26 Epoch: 31, loss: 1.4001, lr: 0.00002871
2025-12-17 20:16:51 train acc=0.922375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0527406005859375, 0.0, 1.0029599609375, 0.2925128173828125, 4.9877890625]
2025-12-17 20:16:51 Epoch: 32, loss: 1.3981, lr: 0.00002591
2025-12-17 20:22:17 train acc=0.9228125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05364154052734375, 0.0, 0.99776171875, 0.2895189208984375, 4.997046875]
2025-12-17 20:22:17 Epoch: 33, loss: 1.3909, lr: 0.00002321
2025-12-17 20:27:42 train acc=0.9233125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05458563232421875, 0.0, 0.9864814453125, 0.2876779174804687, 4.97545703125]
2025-12-17 20:27:42 Epoch: 34, loss: 1.3785, lr: 0.00002061
2025-12-17 20:33:06 train acc=0.9229375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0556319580078125, 0.0, 0.99055712890625, 0.2876463623046875, 4.975359375]
2025-12-17 20:33:06 Epoch: 35, loss: 1.3836, lr: 0.00001813
2025-12-17 20:38:31 train acc=0.9241875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05642962646484375, 0.0, 0.9841708984375, 0.2847353515625, 4.9945390625]
2025-12-17 20:38:31 Epoch: 36, loss: 1.3753, lr: 0.00001577
2025-12-17 20:43:56 train acc=0.923125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05707928466796875, 0.0, 0.9890751953125, 0.2885567626953125, 4.9935]
2025-12-17 20:43:56 Epoch: 37, loss: 1.3846, lr: 0.00001355
2025-12-17 20:49:21 train acc=0.924125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05773828125, 0.0, 0.98019775390625, 0.2850540771484375, 4.9835546875]
2025-12-17 20:49:21 Epoch: 38, loss: 1.3728, lr: 0.00001147
2025-12-17 20:54:46 train acc=0.9219375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05813665771484375, 0.0, 0.9765419921875, 0.28673876953125, 4.97925390625]
2025-12-17 20:54:46 Epoch: 39, loss: 1.3712, lr: 0.00000955
2025-12-17 21:00:11 train acc=0.92325, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05845086669921875, 0.0, 0.97583935546875, 0.283962890625, 4.97528515625]
2025-12-17 21:00:11 Epoch: 40, loss: 1.3680, lr: 0.00000778
2025-12-17 21:05:36 train acc=0.9255, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0588162841796875, 0.0, 0.9761708984375, 0.28268798828125, 4.96462890625]
2025-12-17 21:05:36 Epoch: 41, loss: 1.3673, lr: 0.00000618
2025-12-17 21:11:00 train acc=0.9236875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05902276611328125, 0.0, 0.9727294921875, 0.2875059814453125, 4.969765625]
2025-12-17 21:11:00 Epoch: 42, loss: 1.3690, lr: 0.00000476
2025-12-17 21:16:25 train acc=0.925375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05920257568359375, 0.0, 0.9709169921875, 0.2837354125976562, 4.96849609375]
2025-12-17 21:16:25 Epoch: 43, loss: 1.3635, lr: 0.00000351
2025-12-17 21:21:50 train acc=0.9223125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.059317138671875, 0.0, 0.97421923828125, 0.2848388671875, 4.9675234375]
2025-12-17 21:21:50 Epoch: 44, loss: 1.3680, lr: 0.00000245
2025-12-17 21:27:15 train acc=0.9275, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05961492919921875, 0.0, 0.9680439453125, 0.281051025390625, 4.96657421875]
2025-12-17 21:27:15 Epoch: 45, loss: 1.3584, lr: 0.00000157
2025-12-17 21:32:40 train acc=0.9269375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05967962646484375, 0.0, 0.96657373046875, 0.2825902099609375, 4.9752578125]
2025-12-17 21:32:40 Epoch: 46, loss: 1.3586, lr: 0.00000089
2025-12-17 21:38:05 train acc=0.9250625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05950830078125, 0.0, 0.96713037109375, 0.2826046142578125, 4.9784296875]
2025-12-17 21:38:05 Epoch: 47, loss: 1.3590, lr: 0.00000039
2025-12-17 21:43:37 train acc=0.9268125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05951739501953125, 0.0, 0.9646982421875, 0.2825274658203125, 4.96275]
2025-12-17 21:43:37 Epoch: 48, loss: 1.3564, lr: 0.00000010
2025-12-17 21:49:15 train acc=0.9244375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05957171630859375, 0.0, 0.96746630859375, 0.2803699951171875, 4.9677109375]
2025-12-17 21:49:15 Epoch: 49, loss: 1.3571, lr: 0.00000000
2025-12-17 22:01:55 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 67.462, 'GLR_logits': 70.826, 'final_logits': 70.096, 'acc': 73.19600000000001}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-17 22:01:55 avg clip_logits acc=68.77
2025-12-17 22:01:55 avg cma_logits acc=67.462
2025-12-17 22:01:55 avg GLR_logits acc=70.826
2025-12-17 22:01:55 avg final_logits acc=70.096
2025-12-17 22:01:55 avg acc acc=73.19600000000001
