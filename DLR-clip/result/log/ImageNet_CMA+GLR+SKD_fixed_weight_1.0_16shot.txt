2025-12-20 05:06:16 Preparing ViT-B/16 model.
2025-12-20 05:06:23 Getting cached textual weights W ...
2025-12-20 05:06:23 Initializing CMA adapter learner...
2025-12-20 05:06:23 Initializing SKD distillation...
2025-12-20 05:06:23 Preparing imagenet dataset.
2025-12-20 05:15:54 train acc=0.6810625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0007669025659561157, 0.0, 1.1148447265625, 1.25100439453125, 1.18745703125]
2025-12-20 05:15:54 Epoch: 0, loss: 2.3785, lr: 0.00009990
2025-12-20 05:21:15 train acc=0.7065625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.00171405029296875, 0.0, 1.1194814453125, 1.08445263671875, 1.30848046875]
2025-12-20 05:21:15 Epoch: 1, loss: 2.2187, lr: 0.00009961
2025-12-20 05:26:36 train acc=0.7314375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0024451208114624023, 0.0, 1.11810205078125, 0.9735380859375, 1.510056640625]
2025-12-20 05:26:36 Epoch: 2, loss: 2.1092, lr: 0.00009911
2025-12-20 05:31:57 train acc=0.7494375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.002425078868865967, 0.0, 1.1139482421875, 0.8855009765625, 1.729283203125]
2025-12-20 05:31:57 Epoch: 3, loss: 2.0192, lr: 0.00009843
2025-12-20 05:37:19 train acc=0.766375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0025567798614501954, 0.0, 1.11583203125, 0.81888232421875, 1.9474765625]
2025-12-20 05:37:19 Epoch: 4, loss: 1.9567, lr: 0.00009755
2025-12-20 05:42:40 train acc=0.7780625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.002986095428466797, 0.0, 1.119173828125, 0.764624267578125, 2.1868984375]
2025-12-20 05:42:40 Epoch: 5, loss: 1.9086, lr: 0.00009649
2025-12-20 05:48:01 train acc=0.79225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.003860618591308594, 0.0, 1.11376220703125, 0.712037841796875, 2.410716796875]
2025-12-20 05:48:01 Epoch: 6, loss: 1.8538, lr: 0.00009524
2025-12-20 05:53:22 train acc=0.8046875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.004864040374755859, 0.0, 1.1142626953125, 0.66935498046875, 2.59766015625]
2025-12-20 05:53:22 Epoch: 7, loss: 1.8145, lr: 0.00009382
2025-12-20 05:58:44 train acc=0.81225, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.006245437622070312, 0.0, 1.1133408203125, 0.63422265625, 2.82645703125]
2025-12-20 05:58:44 Epoch: 8, loss: 1.7821, lr: 0.00009222
2025-12-20 06:04:05 train acc=0.8223125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.00780084228515625, 0.0, 1.107529296875, 0.598310791015625, 2.9951015625]
2025-12-20 06:04:05 Epoch: 9, loss: 1.7436, lr: 0.00009045
2025-12-20 06:09:26 train acc=0.8339375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.010049667358398438, 0.0, 1.10247216796875, 0.57113232421875, 3.17389453125]
2025-12-20 06:09:26 Epoch: 10, loss: 1.7154, lr: 0.00008853
2025-12-20 06:14:47 train acc=0.8386875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.012070343017578125, 0.0, 1.104015625, 0.5479586181640625, 3.28427734375]
2025-12-20 06:14:47 Epoch: 11, loss: 1.6969, lr: 0.00008645
2025-12-20 06:20:09 train acc=0.8470625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.01432208251953125, 0.0, 1.097046875, 0.521441162109375, 3.49303125]
2025-12-20 06:20:09 Epoch: 12, loss: 1.6677, lr: 0.00008423
2025-12-20 06:25:30 train acc=0.8548125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.01677348327636719, 0.0, 1.09391748046875, 0.499949951171875, 3.61708203125]
2025-12-20 06:25:30 Epoch: 13, loss: 1.6468, lr: 0.00008187
2025-12-20 06:30:51 train acc=0.8611875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.019111907958984375, 0.0, 1.0837919921875, 0.477201171875, 3.74223046875]
2025-12-20 06:30:51 Epoch: 14, loss: 1.6175, lr: 0.00007939
2025-12-20 06:36:12 train acc=0.8669375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.021441802978515626, 0.0, 1.0823310546875, 0.457464599609375, 3.9121953125]
2025-12-20 06:36:12 Epoch: 15, loss: 1.6004, lr: 0.00007679
2025-12-20 06:41:34 train acc=0.868625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.024020248413085938, 0.0, 1.07997119140625, 0.44903857421875, 4.06430859375]
2025-12-20 06:41:34 Epoch: 16, loss: 1.5937, lr: 0.00007409
2025-12-20 06:46:55 train acc=0.8754375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0266781005859375, 0.0, 1.0652958984375, 0.426618408203125, 4.19126171875]
2025-12-20 06:46:55 Epoch: 17, loss: 1.5605, lr: 0.00007129
2025-12-20 06:52:16 train acc=0.878625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.02935736083984375, 0.0, 1.06131884765625, 0.416161865234375, 4.3288203125]
2025-12-20 06:52:16 Epoch: 18, loss: 1.5502, lr: 0.00006841
2025-12-20 06:57:38 train acc=0.8845, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0315823974609375, 0.0, 1.05911279296875, 0.4016942138671875, 4.44744140625]
2025-12-20 06:57:38 Epoch: 19, loss: 1.5369, lr: 0.00006545
2025-12-20 07:02:59 train acc=0.8850625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.033891815185546875, 0.0, 1.05633154296875, 0.39503466796875, 4.5356171875]
2025-12-20 07:02:59 Epoch: 20, loss: 1.5306, lr: 0.00006243
2025-12-20 07:08:20 train acc=0.8895625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.035922607421875, 0.0, 1.051771484375, 0.3838060302734375, 4.62334765625]
2025-12-20 07:08:20 Epoch: 21, loss: 1.5177, lr: 0.00005937
2025-12-20 07:13:42 train acc=0.8921875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.038069793701171875, 0.0, 1.04085986328125, 0.3734954833984375, 4.72448828125]
2025-12-20 07:13:42 Epoch: 22, loss: 1.4997, lr: 0.00005627
2025-12-20 07:19:03 train acc=0.8954375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0400606689453125, 0.0, 1.03787060546875, 0.3628414306640625, 4.77610546875]
2025-12-20 07:19:03 Epoch: 23, loss: 1.4886, lr: 0.00005314
2025-12-20 07:24:24 train acc=0.8968125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.042027587890625, 0.0, 1.02803564453125, 0.3569266357421875, 4.88908984375]
2025-12-20 07:24:24 Epoch: 24, loss: 1.4759, lr: 0.00005000
2025-12-20 07:29:45 train acc=0.897, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0441248779296875, 0.0, 1.0248486328125, 0.3564151611328125, 4.9056875]
2025-12-20 07:29:45 Epoch: 25, loss: 1.4744, lr: 0.00004686
2025-12-20 07:35:07 train acc=0.9031875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.04608203125, 0.0, 1.02085986328125, 0.342079345703125, 4.9501015625]
2025-12-20 07:35:07 Epoch: 26, loss: 1.4585, lr: 0.00004373
2025-12-20 07:40:28 train acc=0.904875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0477288818359375, 0.0, 1.01524853515625, 0.341891357421875, 5.0326640625]
2025-12-20 07:40:28 Epoch: 27, loss: 1.4552, lr: 0.00004063
2025-12-20 07:45:49 train acc=0.9064375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0491583251953125, 0.0, 1.008845703125, 0.3346724853515625, 5.061828125]
2025-12-20 07:45:49 Epoch: 28, loss: 1.4433, lr: 0.00003757
2025-12-20 07:51:10 train acc=0.9066875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05066455078125, 0.0, 1.00854248046875, 0.331431396484375, 5.0687890625]
2025-12-20 07:51:10 Epoch: 29, loss: 1.4413, lr: 0.00003455
2025-12-20 07:56:31 train acc=0.9065625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0513939208984375, 0.0, 1.004427734375, 0.3268931884765625, 5.1190234375]
2025-12-20 07:56:31 Epoch: 30, loss: 1.4339, lr: 0.00003159
2025-12-20 08:01:53 train acc=0.909125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05284368896484375, 0.0, 0.9944560546875, 0.325430908203125, 5.147]
2025-12-20 08:01:53 Epoch: 31, loss: 1.4242, lr: 0.00002871
2025-12-20 08:07:14 train acc=0.9118125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05409527587890625, 0.0, 0.9933544921875, 0.322814697265625, 5.1722890625]
2025-12-20 08:07:14 Epoch: 32, loss: 1.4220, lr: 0.00002591
2025-12-20 08:12:35 train acc=0.909375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0548760986328125, 0.0, 0.9883759765625, 0.320229248046875, 5.1670625]
2025-12-20 08:12:35 Epoch: 33, loss: 1.4152, lr: 0.00002321
2025-12-20 08:17:56 train acc=0.911375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0555811767578125, 0.0, 0.977228515625, 0.3180848388671875, 5.1689140625]
2025-12-20 08:17:56 Epoch: 34, loss: 1.4026, lr: 0.00002061
2025-12-20 08:23:18 train acc=0.9114375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05640789794921875, 0.0, 0.98079296875, 0.3207474365234375, 5.17040625]
2025-12-20 08:23:18 Epoch: 35, loss: 1.4096, lr: 0.00001813
2025-12-20 08:28:39 train acc=0.913, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05699462890625, 0.0, 0.97551513671875, 0.3144068603515625, 5.1778125]
2025-12-20 08:28:39 Epoch: 36, loss: 1.3987, lr: 0.00001577
2025-12-20 08:34:00 train acc=0.9113125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0574962158203125, 0.0, 0.980125, 0.3184205322265625, 5.1758203125]
2025-12-20 08:34:00 Epoch: 37, loss: 1.4078, lr: 0.00001355
2025-12-20 08:39:21 train acc=0.9120625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0580062255859375, 0.0, 0.97180615234375, 0.3149285888671875, 5.187453125]
2025-12-20 08:39:21 Epoch: 38, loss: 1.3966, lr: 0.00001147
2025-12-20 08:44:43 train acc=0.9095625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05832855224609375, 0.0, 0.9674853515625, 0.3168673095703125, 5.1822265625]
2025-12-20 08:44:43 Epoch: 39, loss: 1.3945, lr: 0.00000955
2025-12-20 08:50:04 train acc=0.9121875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0586663818359375, 0.0, 0.96725927734375, 0.3143822021484375, 5.1826953125]
2025-12-20 08:50:04 Epoch: 40, loss: 1.3922, lr: 0.00000778
2025-12-20 08:55:25 train acc=0.914125, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05878375244140625, 0.0, 0.96731298828125, 0.312760009765625, 5.172421875]
2025-12-20 08:55:25 Epoch: 41, loss: 1.3906, lr: 0.00000618
2025-12-20 09:00:47 train acc=0.91375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.059105712890625, 0.0, 0.963435546875, 0.3162177734375, 5.1789375]
2025-12-20 09:00:47 Epoch: 42, loss: 1.3906, lr: 0.00000476
2025-12-20 09:06:08 train acc=0.9119375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05915936279296875, 0.0, 0.96203076171875, 0.31424822998046875, 5.179796875]
2025-12-20 09:06:08 Epoch: 43, loss: 1.3873, lr: 0.00000351
2025-12-20 09:11:29 train acc=0.9095, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0596048583984375, 0.0, 0.9654521484375, 0.3150089111328125, 5.18]
2025-12-20 09:11:29 Epoch: 44, loss: 1.3918, lr: 0.00000245
2025-12-20 09:16:50 train acc=0.912875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.0593720703125, 0.0, 0.95922119140625, 0.3121041259765625, 5.173578125]
2025-12-20 09:16:50 Epoch: 45, loss: 1.3824, lr: 0.00000157
2025-12-20 09:22:12 train acc=0.912625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05932086181640625, 0.0, 0.9578896484375, 0.3141806640625, 5.18371875]
2025-12-20 09:22:12 Epoch: 46, loss: 1.3832, lr: 0.00000089
2025-12-20 09:27:33 train acc=0.9135625, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05945635986328125, 0.0, 0.957580078125, 0.3137882080078125, 5.18384375]
2025-12-20 09:27:33 Epoch: 47, loss: 1.3827, lr: 0.00000039
2025-12-20 09:32:54 train acc=0.911875, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05955743408203125, 0.0, 0.95559423828125, 0.3150413818359375, 5.1745546875]
2025-12-20 09:32:54 Epoch: 48, loss: 1.3819, lr: 0.00000010
2025-12-20 09:38:16 train acc=0.91375, [l1_loss1, l1_loss2, ce_loss, ce_loss2, ce_loss3, kd_loss] => [0.0, 0.05951953125, 0.0, 0.95885205078125, 0.3096783447265625, 5.1825625]
2025-12-20 09:38:16 Epoch: 49, loss: 1.3799, lr: 0.00000000
2025-12-20 09:52:16 {'name': 'imagenet', 'acc': [{'clip_logits': 68.77, 'cma_logits': 70.166, 'GLR_logits': 70.858, 'final_logits': 72.64, 'acc': 73.21600000000001}], 'detail': 'dataset_name=imagenet, shots=16, lr=0.001, seed=2024, train_epoch=50, batch_size=32, backbone=ViT-B/16, num_classes=1000, loss_lambda=[1.0, 1.0, 1.0, 1.0, 1.0], fuse_type=2'}
2025-12-20 09:52:16 avg clip_logits acc=68.77
2025-12-20 09:52:16 avg cma_logits acc=70.166
2025-12-20 09:52:16 avg GLR_logits acc=70.858
2025-12-20 09:52:16 avg final_logits acc=72.64
2025-12-20 09:52:16 avg acc acc=73.21600000000001
